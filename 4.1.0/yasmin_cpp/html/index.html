<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C++ YASMIN (Yet Another State MachINe): YASMIN (Yet Another State MachINe)</title>
<link rel="icon" href="logo.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">C++ YASMIN (Yet Another State MachINe)
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">YASMIN (Yet Another State MachINe) </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a></p>
<p align="center"></p>
<p><img src="./docs/logo.png" alt="" width="50%" class="inline"/> </p>
<p><b>YASMIN</b> is a project focused on implementing robot behaviors using Finite State Machines (FSM). It is available for ROS 2, Python and C++.</p>
<div align="center"></div><div align="center"><a href="https://opensource.org/license/gpl-3-0"><img src="https://img.shields.io/badge/GitHub-GPL--3.0-informational" alt="License: MIT" class="inline"/></a> <a href="https://github.com/uleroboticsgroup/yasmin/releases"><img src="https://img.shields.io/github/release/uleroboticsgroup/yasmin.svg" alt="GitHub release" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/uleroboticsgroup/yasmin?branch=main"><img src="https://img.shields.io/github/languages/code-size/uleroboticsgroup/yasmin.svg?branch=main" alt="Code Size" style="pointer-events: none;" class="inline"/></a> <a href="https://libraries.io/github/uleroboticsgroup/yasmin?branch=main"><img src="https://img.shields.io/librariesio/github/uleroboticsgroup/yasmin?branch=main" alt="Dependencies" class="inline"/></a> <a href="https://github.com/uleroboticsgroup/yasmin/commits/main"><img src="https://img.shields.io/github/last-commit/uleroboticsgroup/yasmin.svg" alt="Last Commit" style="pointer-events: none;" class="inline"/></a></div><div align="center"><a href="https://github.com/uleroboticsgroup/yasmin/issues"><img src="https://img.shields.io/github/issues/uleroboticsgroup/yasmin" alt="GitHub issues" class="inline"/></a> <a href="https://github.com/uleroboticsgroup/yasmin/pulls"><img src="https://img.shields.io/github/issues-pr/uleroboticsgroup/yasmin" alt="GitHub pull requests" class="inline"/></a> <a href="https://github.com/uleroboticsgroup/yasmin/graphs/contributors"><img src="https://img.shields.io/github/contributors/uleroboticsgroup/yasmin.svg" alt="Contributors" style="pointer-events: none;" class="inline"/></a></div><div align="center"><a href="https://github.com/uleroboticsgroup/yasmin/actions/workflows/python-formatter.yml?branch=main"><img src="https://github.com/uleroboticsgroup/yasmin/actions/workflows/python-formatter.yml/badge.svg?branch=main" alt="Python Formatter Check" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/uleroboticsgroup/yasmin/actions/workflows/cpp-formatter.yml?branch=main"><img src="https://github.com/uleroboticsgroup/yasmin/actions/workflows/cpp-formatter.yml/badge.svg?branch=main" alt="C++ Formatter Check" style="pointer-events: none;" class="inline"/></a> <a href="https://uleroboticsgroup.github.io/yasmin"><img src="https://github.com/uleroboticsgroup/yasmin/actions/workflows/documentation-deployment.yml/badge.svg" alt="Documentation Deployment" style="pointer-events: none;" class="inline"/></a></div><div align="center"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">ROS 2 Distro   </th><th class="markdownTableHeadCenter">Build and Test   </th><th class="markdownTableHeadCenter">Docker Image    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><b>Foxy</b>   </td><td class="markdownTableBodyCenter"><a href="https://github.com/uleroboticsgroup/yasmin/actions/workflows/foxy-build-test.yml?branch=main"><img src="https://github.com/uleroboticsgroup/yasmin/actions/workflows/foxy-build-test.yml/badge.svg?branch=main" alt="Foxy Build" style="pointer-events: none;" class="inline"/></a>   </td><td class="markdownTableBodyCenter"><a href="https://hub.docker.com/r/mgons/yasmin/tags?name=foxy"><img src="https://img.shields.io/badge/Docker%20Image%20-foxy-blue" alt="Docker Image" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><b>Galatic</b>   </td><td class="markdownTableBodyCenter"><a href="https://github.com/uleroboticsgroup/yasmin/actions/workflows/galactic-build-test.yml?branch=main"><img src="https://github.com/uleroboticsgroup/yasmin/actions/workflows/galactic-build-test.yml/badge.svg?branch=main" alt="Galactic Build" style="pointer-events: none;" class="inline"/></a>   </td><td class="markdownTableBodyCenter"><a href="https://hub.docker.com/r/mgons/yasmin/tags?name=galactic"><img src="https://img.shields.io/badge/Docker%20Image%20-galactic-blue" alt="Docker Image" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><b>Humble</b>   </td><td class="markdownTableBodyCenter"><a href="https://github.com/uleroboticsgroup/yasmin/actions/workflows/humble-build-test.yml?branch=main"><img src="https://github.com/uleroboticsgroup/yasmin/actions/workflows/humble-build-test.yml/badge.svg?branch=main" alt="Humble Build and Test" style="pointer-events: none;" class="inline"/></a>   </td><td class="markdownTableBodyCenter"><a href="https://hub.docker.com/r/mgons/yasmin/tags?name=humble"><img src="https://img.shields.io/badge/Docker%20Image%20-humble-blue" alt="Docker Image" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><b>Iron</b>   </td><td class="markdownTableBodyCenter"><a href="https://github.com/uleroboticsgroup/yasmin/actions/workflows/iron-build-test.yml?branch=main"><img src="https://github.com/uleroboticsgroup/yasmin/actions/workflows/iron-build-test.yml/badge.svg?branch=main" alt="Iron Build" style="pointer-events: none;" class="inline"/></a>   </td><td class="markdownTableBodyCenter"><a href="https://hub.docker.com/r/mgons/yasmin/tags?name=iron"><img src="https://img.shields.io/badge/Docker%20Image%20-iron-blue" alt="Docker Image" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><b>Jazzy</b>   </td><td class="markdownTableBodyCenter"><a href="https://github.com/uleroboticsgroup/yasmin/actions/workflows/jazzy-build-test.yml?branch=main"><img src="https://github.com/uleroboticsgroup/yasmin/actions/workflows/jazzy-build-test.yml/badge.svg?branch=main" alt="Jazzy Build" style="pointer-events: none;" class="inline"/></a>   </td><td class="markdownTableBodyCenter"><a href="https://hub.docker.com/r/mgons/yasmin/tags?name=jazzy"><img src="https://img.shields.io/badge/Docker%20Image%20-jazzy-blue" alt="Docker Image" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><b>Kilted</b>   </td><td class="markdownTableBodyCenter"><a href="https://github.com/uleroboticsgroup/yasmin/actions/workflows/kilted-build-test.yml?branch=main"><img src="https://github.com/uleroboticsgroup/yasmin/actions/workflows/kilted-build-test.yml/badge.svg?branch=main" alt="Kilted Build" style="pointer-events: none;" class="inline"/></a>   </td><td class="markdownTableBodyCenter"><a href="https://hub.docker.com/r/mgons/yasmin/tags?name=kilted"><img src="https://img.shields.io/badge/Docker%20Image%20-kilted-blue" alt="Docker Image" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><b>Rolling</b>   </td><td class="markdownTableBodyCenter"><a href="https://github.com/uleroboticsgroup/yasmin/actions/workflows/rolling-build-test.yml?branch=main"><img src="https://github.com/uleroboticsgroup/yasmin/actions/workflows/rolling-build-test.yml/badge.svg?branch=main" alt="Rolling Build" style="pointer-events: none;" class="inline"/></a>   </td><td class="markdownTableBodyCenter"><a href="https://hub.docker.com/r/mgons/yasmin/tags?name=rolling"><img src="https://img.shields.io/badge/Docker%20Image%20-rolling-blue" alt="Docker Image" class="inline"/></a>   </td></tr>
</table>
</div><div align="center"></div><h1><a class="anchor" id="autotoc_md1"></a>
Table of Contents</h1>
<ol type="1">
<li>Features</li>
<li>Installation<ul>
<li>Debian Packages</li>
<li>Building from Source</li>
<li>Docker</li>
</ul>
</li>
<li>Demos<ul>
<li>Python</li>
<li>Cpp</li>
</ul>
</li>
<li>YASMIN Editor<ul>
<li>Getting Started</li>
</ul>
</li>
<li>YASMIN Viewer<ul>
<li>Getting Started</li>
<li>Custom Host and Port</li>
</ul>
</li>
<li>Citations</li>
</ol>
<h1><a class="anchor" id="autotoc_md2"></a>
Key Features</h1>
<ul>
<li><b>ROS 2 Integration</b>: Integrates with ROS 2 for easy deployment and interaction.</li>
<li><b>Support for Python and C++</b>: Available for both Python and C++, making it flexible for a variety of use cases.</li>
<li><b>Rapid Prototyping</b>: Designed for fast prototyping, allowing quick iteration of state machine behaviors.</li>
<li><b>Predefined States</b>: Includes states for interacting with ROS 2 action clients, service clients, and topics.</li>
<li><b>Data Sharing with Blackboards</b>: Utilizes blackboards for data sharing between states and state machines.</li>
<li><b>State Management</b>: Supports cancellation and stopping of state machines, including halting the current executing state.</li>
<li><b>Web Viewer</b>: Features an integrated web viewer for real-time monitoring of state machine execution.</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Installation</h1>
<h2><a class="anchor" id="autotoc_md4"></a>
Debian Packages</h2>
<p>To install YASMIN and its packages, use the following command:</p>
<div class="fragment"><div class="line">sudo apt install ros-$ROS_DISTRO-yasmin ros-$ROS_DISTRO-yasmin-*</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md5"></a>
Building from Source</h2>
<p>Follow these steps to build the source code from this repository:</p>
<div class="fragment"><div class="line">cd ~/ros2_ws/src</div>
<div class="line">git clone https://github.com/uleroboticsgroup/yasmin.git</div>
<div class="line">cd ~/ros2_ws</div>
<div class="line">rosdep install --from-paths src --ignore-src -r -y</div>
<div class="line">colcon build</div>
</div><!-- fragment --><p>Then, you can run the tests as follow:</p>
<div class="fragment"><div class="line">colcon test --packages-select yasmin yasmin_ros yasmin_factory</div>
<div class="line">colcon test-result --verbose</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md6"></a>
Docker</h2>
<p>If your operating system doesn't support ROS 2, docker is a great alternative. You can use an image from <a href="https://hub.docker.com/r/mgons/yasmin/">Dockerhub</a> or create your own images. First of all, to build the image you have to use the following command:</p>
<div class="fragment"><div class="line">## Assuming you are in the YASMIN project directory</div>
<div class="line">docker build -t yasmin .</div>
</div><!-- fragment --><p>To use a shortcut the docker build, you may use the following command:</p>
<div class="fragment"><div class="line">## Assuming you are in the YASMIN project directory</div>
<div class="line">make docker_build</div>
</div><!-- fragment --><p>After the image is created, run a docker container with the following command:</p>
<div class="fragment"><div class="line">docker run -it --net=host --ipc=host --privileged --env=&quot;DISPLAY&quot; --env=&quot;QT_X11_NO_MITSHM=1&quot; --volume=&quot;/tmp/.X11-unix:/tmp/.X11-unix:rw&quot; --volume=&quot;${XAUTHORITY}:/root/.Xauthority&quot; --entrypoint /bin/bash yasmin</div>
</div><!-- fragment --><p>To use a shortcut the docker run, you may use following command:</p>
<div class="fragment"><div class="line">## Assuming you are in the YASMIN project directory</div>
<div class="line">make docker_run</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
Demos</h1>
<p>There are some examples, for both Python and C++, that can be found in <a href="./yasmin_demos/">yasmin_demos</a>.</p>
<p><img src="./docs/demo.gif" alt="" width="65%" class="inline"/> </p>
<h2><a class="anchor" id="autotoc_md8"></a>
Python</h2>
<h3><a class="anchor" id="autotoc_md9"></a>
Vanilla Demo (FSM)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos yasmin_demo.py</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">import</span> time</div>
<div class="line"><span class="keyword">import</span> rclpy</div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> yasmin</div>
<div class="line"><span class="keyword">from</span> yasmin <span class="keyword">import</span> State, Blackboard, StateMachine</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> set_ros_loggers</div>
<div class="line"><span class="keyword">from</span> yasmin_viewer <span class="keyword">import</span> YasminViewerPub</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Define the FooState class, inheriting from the State class</span></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classFooState.html">FooState</a>(State):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Represents the Foo state in the state machine.</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>__init__(self) -&gt; None:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Initializes the FooState instance, setting up the outcomes.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Outcomes:</span></div>
<div class="line"><span class="stringliteral">            outcome1: Indicates the state should continue to the Bar state.</span></div>
<div class="line"><span class="stringliteral">            outcome2: Indicates the state should finish execution and return.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        super().__init__([<span class="stringliteral">&quot;outcome1&quot;</span>, <span class="stringliteral">&quot;outcome2&quot;</span>])</div>
<div class="line">        self.counter = 0</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>execute(self, blackboard: Blackboard) -&gt; str:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Executes the logic for the Foo state.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The shared data structure for states.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            str: The outcome of the execution, which can be &quot;outcome1&quot; or &quot;outcome2&quot;.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Raises:</span></div>
<div class="line"><span class="stringliteral">            Exception: May raise exceptions related to state execution.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;Executing state FOO&quot;</span>)</div>
<div class="line">        time.sleep(3)  <span class="comment"># Simulate work by sleeping</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> self.counter &lt; 3:</div>
<div class="line">            self.counter += 1</div>
<div class="line">            blackboard[<span class="stringliteral">&quot;foo_str&quot;</span>] = f<span class="stringliteral">&quot;Counter: {self.counter}&quot;</span></div>
<div class="line">            <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome1&quot;</span></div>
<div class="line">        <span class="keywordflow">else</span>:</div>
<div class="line">            <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome2&quot;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Define the BarState class, inheriting from the State class</span></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classBarState.html">BarState</a>(State):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Represents the Bar state in the state machine.</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>__init__(self) -&gt; None:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Initializes the BarState instance, setting up the outcome.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Outcomes:</span></div>
<div class="line"><span class="stringliteral">            outcome3: Indicates the state should transition back to the Foo state.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        super().__init__(outcomes=[<span class="stringliteral">&quot;outcome3&quot;</span>])</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>execute(self, blackboard: Blackboard) -&gt; str:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Executes the logic for the Bar state.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The shared data structure for states.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            str: The outcome of the execution, which will always be &quot;outcome3&quot;.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Raises:</span></div>
<div class="line"><span class="stringliteral">            Exception: May raise exceptions related to state execution.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;Executing state BAR&quot;</span>)</div>
<div class="line">        time.sleep(3)  <span class="comment"># Simulate work by sleeping</span></div>
<div class="line"> </div>
<div class="line">        yasmin.YASMIN_LOG_INFO(blackboard[<span class="stringliteral">&quot;foo_str&quot;</span>])</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome3&quot;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span><a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>() -&gt; None:</div>
<div class="line">    yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;yasmin_demo&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Initialize ROS 2</span></div>
<div class="line">    rclpy.init()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Set ROS 2 loggers</span></div>
<div class="line">    set_ros_loggers()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Create a finite state machine (FSM)</span></div>
<div class="line">    sm = StateMachine(outcomes=[<span class="stringliteral">&quot;outcome4&quot;</span>], handle_sigint=<span class="keyword">True</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Add states to the FSM</span></div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;FOO&quot;</span>,</div>
<div class="line">        <a class="code hl_class" href="classFooState.html">FooState</a>(),</div>
<div class="line">        transitions={</div>
<div class="line">            <span class="stringliteral">&quot;outcome1&quot;</span>: <span class="stringliteral">&quot;BAR&quot;</span>,</div>
<div class="line">            <span class="stringliteral">&quot;outcome2&quot;</span>: <span class="stringliteral">&quot;outcome4&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;BAR&quot;</span>,</div>
<div class="line">        <a class="code hl_class" href="classBarState.html">BarState</a>(),</div>
<div class="line">        transitions={</div>
<div class="line">            <span class="stringliteral">&quot;outcome3&quot;</span>: <span class="stringliteral">&quot;FOO&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Publish FSM information for visualization</span></div>
<div class="line">    viewer = YasminViewerPub(sm, <span class="stringliteral">&quot;YASMIN_DEMO&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Execute the FSM</span></div>
<div class="line">    <span class="keywordflow">try</span>:</div>
<div class="line">        outcome = sm()</div>
<div class="line">        yasmin.YASMIN_LOG_INFO(outcome)</div>
<div class="line">    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">        yasmin.YASMIN_LOG_WARN(e)</div>
<div class="line">    <span class="keywordflow">finally</span>:</div>
<div class="line">        viewer.cleanup()</div>
<div class="line">        del sm</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Shutdown ROS 2 if it&#39;s running</span></div>
<div class="line">    <span class="keywordflow">if</span> rclpy.ok():</div>
<div class="line">        rclpy.shutdown()</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
<div class="ttc" id="aclassBarState_html"><div class="ttname"><a href="classBarState.html">BarState</a></div><div class="ttdoc">Represents the &quot;Bar&quot; state in the state machine.</div><div class="ttdef"><b>Definition</b> test_concurrence.cpp:42</div></div>
<div class="ttc" id="aclassFooState_html"><div class="ttname"><a href="classFooState.html">FooState</a></div><div class="ttdoc">Represents the &quot;Foo&quot; state in the state machine.</div><div class="ttdef"><b>Definition</b> test_concurrence.cpp:29</div></div>
<div class="ttc" id="atest__blackboard_8cpp_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition</b> test_blackboard.cpp:62</div></div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md10"></a>
Blackboard Remapping Demo</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos remap_demo.py</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">import</span> rclpy</div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> yasmin</div>
<div class="line"><span class="keyword">from</span> yasmin <span class="keyword">import</span> State, Blackboard, StateMachine</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> set_ros_loggers</div>
<div class="line"><span class="keyword">from</span> <a class="code hl_namespace" href="namespaceyasmin__ros_1_1basic__outcomes.html">yasmin_ros.basic_outcomes</a> <span class="keyword">import</span> SUCCEED</div>
<div class="line"><span class="keyword">from</span> yasmin_viewer <span class="keyword">import</span> YasminViewerPub</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Foo(State):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Represents the Foo state in the state machine.</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>__init__(self):</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Initializes the FooState instance, setting up the outcomes.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Outcomes:</span></div>
<div class="line"><span class="stringliteral">            SUCCEED: Indicates the state should continue to the next state.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        super().__init__(outcomes=[SUCCEED])</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>execute(self, blackboard: Blackboard):</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Executes the logic for the Foo state.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The shared data structure for states.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            str: The outcome of the execution, which can be SUCCEED.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Raises:</span></div>
<div class="line"><span class="stringliteral">            Exception: May raise exceptions related to state execution.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        data = blackboard[<span class="stringliteral">&quot;foo_data&quot;</span>]</div>
<div class="line">        yasmin.YASMIN_LOG_INFO(f<span class="stringliteral">&quot;{data}&quot;</span>)</div>
<div class="line">        blackboard[<span class="stringliteral">&quot;foo_out_data&quot;</span>] = data</div>
<div class="line">        <span class="keywordflow">return</span> SUCCEED</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classBarState.html">BarState</a>(State):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Represents the Bar state in the state machine.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>__init__(self):</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Initializes the BarState instance, setting up the outcomes.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Outcomes:</span></div>
<div class="line"><span class="stringliteral">            SUCCEDED: Indicates the state should continue to the next state.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        super().__init__(outcomes=[SUCCEED])</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>execute(self, blackboard: Blackboard):</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Executes the logic for the Bar state.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The shared data structure for states.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            str: The outcome of the execution, which can be SUCCEED.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Raises:</span></div>
<div class="line"><span class="stringliteral">            Exception: May raise exceptions related to state execution.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        data = blackboard[<span class="stringliteral">&quot;bar_data&quot;</span>]</div>
<div class="line">        yasmin.YASMIN_LOG_INFO(f<span class="stringliteral">&quot;{data}&quot;</span>)</div>
<div class="line">        <span class="keywordflow">return</span> SUCCEED</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span><a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>() -&gt; None:</div>
<div class="line">    yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;yasmin_remapping_demo&quot;</span>)</div>
<div class="line">    rclpy.init()</div>
<div class="line">    set_ros_loggers()</div>
<div class="line"> </div>
<div class="line">    blackboard = Blackboard()</div>
<div class="line">    blackboard[<span class="stringliteral">&quot;msg1&quot;</span>] = <span class="stringliteral">&quot;test1&quot;</span></div>
<div class="line">    blackboard[<span class="stringliteral">&quot;msg2&quot;</span>] = <span class="stringliteral">&quot;test2&quot;</span></div>
<div class="line"> </div>
<div class="line">    sm = StateMachine(outcomes=[SUCCEED], handle_sigint=<span class="keyword">True</span>)</div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;STATE1&quot;</span>,</div>
<div class="line">        Foo(),</div>
<div class="line">        transitions={SUCCEED: <span class="stringliteral">&quot;STATE2&quot;</span>},</div>
<div class="line">        remappings={<span class="stringliteral">&quot;foo_data&quot;</span>: <span class="stringliteral">&quot;msg1&quot;</span>},</div>
<div class="line">    )</div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;STATE2&quot;</span>,</div>
<div class="line">        Foo(),</div>
<div class="line">        transitions={SUCCEED: <span class="stringliteral">&quot;STATE3&quot;</span>},</div>
<div class="line">        remappings={<span class="stringliteral">&quot;foo_data&quot;</span>: <span class="stringliteral">&quot;msg2&quot;</span>},</div>
<div class="line">    )</div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;STATE3&quot;</span>,</div>
<div class="line">        <a class="code hl_class" href="classBarState.html">BarState</a>(),</div>
<div class="line">        transitions={SUCCEED: SUCCEED},</div>
<div class="line">        remappings={<span class="stringliteral">&quot;bar_data&quot;</span>: <span class="stringliteral">&quot;foo_out_data&quot;</span>},</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Launch YASMIN Viewer publisher for state visualization</span></div>
<div class="line">    viewer = YasminViewerPub(sm, <span class="stringliteral">&quot;YASMIN_REMAPPING_DEMO&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Execute the FSM</span></div>
<div class="line">    <span class="keywordflow">try</span>:</div>
<div class="line">        outcome = sm(blackboard)</div>
<div class="line">        yasmin.YASMIN_LOG_INFO(outcome)</div>
<div class="line">    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">        yasmin.YASMIN_LOG_WARN(e)</div>
<div class="line">    <span class="keywordflow">finally</span>:</div>
<div class="line">        viewer.cleanup()</div>
<div class="line">        del sm</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Shutdown ROS 2 if it&#39;s running</span></div>
<div class="line">    <span class="keywordflow">if</span> rclpy.ok():</div>
<div class="line">        rclpy.shutdown()</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
<div class="ttc" id="anamespaceyasmin__ros_1_1basic__outcomes_html"><div class="ttname"><a href="namespaceyasmin__ros_1_1basic__outcomes.html">yasmin_ros::basic_outcomes</a></div><div class="ttdoc">Provides common outcome constants for ROS 2.</div></div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md11"></a>
Concurrence Demo</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos concurrence_demo.py</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">import</span> time</div>
<div class="line"><span class="keyword">import</span> rclpy</div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> yasmin</div>
<div class="line"><span class="keyword">from</span> yasmin <span class="keyword">import</span> State, Concurrence, Blackboard, StateMachine</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> set_ros_loggers</div>
<div class="line"><span class="keyword">from</span> yasmin_viewer <span class="keyword">import</span> YasminViewerPub</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Define the FooState class, inheriting from the State class</span></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classFooState.html">FooState</a>(State):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Represents the Foo state in the state machine.</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>__init__(self) -&gt; None:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Initializes the FooState instance, setting up the outcomes.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Outcomes:</span></div>
<div class="line"><span class="stringliteral">            outcome1: Indicates the state should continue.</span></div>
<div class="line"><span class="stringliteral">            outcome2: Indicates the state should cotninue.</span></div>
<div class="line"><span class="stringliteral">            outcome3: Indicates the state should finish execution and return.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        super().__init__([<span class="stringliteral">&quot;outcome1&quot;</span>, <span class="stringliteral">&quot;outcome2&quot;</span>, <span class="stringliteral">&quot;outcome3&quot;</span>])</div>
<div class="line">        self.counter = 0</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>execute(self, blackboard: Blackboard) -&gt; str:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Executes the logic for the Foo state.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The shared data structure for states.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            str: The outcome of the execution.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Raises:</span></div>
<div class="line"><span class="stringliteral">            Exception: May raise exceptions related to state execution.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;Executing state FOO&quot;</span>)</div>
<div class="line">        time.sleep(2)  <span class="comment"># Simulate work by sleeping</span></div>
<div class="line"> </div>
<div class="line">        outcome = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line">        blackboard[<span class="stringliteral">&quot;foo_str&quot;</span>] = f<span class="stringliteral">&quot;Counter: {self.counter}&quot;</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> self.counter &lt; 3:</div>
<div class="line">            outcome = <span class="stringliteral">&quot;outcome1&quot;</span></div>
<div class="line">        <span class="keywordflow">elif</span> self.counter &lt; 5:</div>
<div class="line">            outcome = <span class="stringliteral">&quot;outcome2&quot;</span></div>
<div class="line">        <span class="keywordflow">else</span>:</div>
<div class="line">            outcome = <span class="stringliteral">&quot;outcome3&quot;</span></div>
<div class="line"> </div>
<div class="line">        yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;Finishing state FOO&quot;</span>)</div>
<div class="line">        self.counter += 1</div>
<div class="line">        <span class="keywordflow">return</span> outcome</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Define the BarState class, inheriting from the State class</span></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classBarState.html">BarState</a>(State):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Represents the Bar state in the state machine.</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>__init__(self) -&gt; None:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Initializes the BarState instance, setting up the outcome.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Outcomes:</span></div>
<div class="line"><span class="stringliteral">            outcome3: This state will always return this outcome</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        super().__init__(outcomes=[<span class="stringliteral">&quot;outcome3&quot;</span>])</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>execute(self, blackboard: Blackboard) -&gt; str:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Executes the logic for the Bar state.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The shared data structure for states.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            str: The outcome of the execution, which will always be &quot;outcome3&quot;.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Raises:</span></div>
<div class="line"><span class="stringliteral">            Exception: May raise exceptions related to state execution.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;Executing state BAR&quot;</span>)</div>
<div class="line">        time.sleep(4)  <span class="comment"># Simulate work by sleeping</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> <span class="stringliteral">&quot;foo_str&quot;</span> <span class="keywordflow">in</span> blackboard:</div>
<div class="line">            yasmin.YASMIN_LOG_INFO(blackboard[<span class="stringliteral">&quot;foo_str&quot;</span>])</div>
<div class="line">        <span class="keywordflow">else</span>:</div>
<div class="line">            yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;Blackboard does not yet contain &#39;foo_str&#39;&quot;</span>)</div>
<div class="line"> </div>
<div class="line">        yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;Finishing state BAR&quot;</span>)</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome3&quot;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span><a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>() -&gt; None:</div>
<div class="line">    yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;CONCURRENCE_DEMO&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Initialize ROS 2</span></div>
<div class="line">    rclpy.init()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Set ROS 2 loggers</span></div>
<div class="line">    set_ros_loggers()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Create a finite state machine (FSM)</span></div>
<div class="line">    sm = StateMachine(outcomes=[<span class="stringliteral">&quot;outcome4&quot;</span>], handle_sigint=<span class="keyword">True</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Create states to run concurrently</span></div>
<div class="line">    foo_state: State = <a class="code hl_class" href="classFooState.html">FooState</a>()</div>
<div class="line">    bar_state: State = <a class="code hl_class" href="classBarState.html">BarState</a>()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Add concurrence state</span></div>
<div class="line">    concurrence_state = Concurrence(</div>
<div class="line">        states={</div>
<div class="line">            <span class="stringliteral">&quot;FOO&quot;</span>: foo_state,</div>
<div class="line">            <span class="stringliteral">&quot;BAR&quot;</span>: bar_state,</div>
<div class="line">        },</div>
<div class="line">        default_outcome=<span class="stringliteral">&quot;defaulted&quot;</span>,</div>
<div class="line">        outcome_map={</div>
<div class="line">            <span class="stringliteral">&quot;outcome1&quot;</span>: {</div>
<div class="line">                <span class="stringliteral">&quot;FOO&quot;</span>: <span class="stringliteral">&quot;outcome1&quot;</span>,</div>
<div class="line">                <span class="stringliteral">&quot;BAR&quot;</span>: <span class="stringliteral">&quot;outcome3&quot;</span>,</div>
<div class="line">            },</div>
<div class="line">            <span class="stringliteral">&quot;outcome2&quot;</span>: {</div>
<div class="line">                <span class="stringliteral">&quot;FOO&quot;</span>: <span class="stringliteral">&quot;outcome2&quot;</span>,</div>
<div class="line">                <span class="stringliteral">&quot;BAR&quot;</span>: <span class="stringliteral">&quot;outcome3&quot;</span>,</div>
<div class="line">            },</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Add concurrent state to the FSM</span></div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;CONCURRENCE&quot;</span>,</div>
<div class="line">        concurrence_state,</div>
<div class="line">        transitions={</div>
<div class="line">            <span class="stringliteral">&quot;outcome1&quot;</span>: <span class="stringliteral">&quot;CONCURRENCE&quot;</span>,</div>
<div class="line">            <span class="stringliteral">&quot;outcome2&quot;</span>: <span class="stringliteral">&quot;CONCURRENCE&quot;</span>,</div>
<div class="line">            <span class="stringliteral">&quot;defaulted&quot;</span>: <span class="stringliteral">&quot;outcome4&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Publish FSM information for visualization</span></div>
<div class="line">    viewer = YasminViewerPub(sm, <span class="stringliteral">&quot;YASMIN_CONCURRENCE_DEMO&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Execute the FSM</span></div>
<div class="line">    <span class="keywordflow">try</span>:</div>
<div class="line">        outcome = sm()</div>
<div class="line">        yasmin.YASMIN_LOG_INFO(outcome)</div>
<div class="line">    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">        yasmin.YASMIN_LOG_WARN(e)</div>
<div class="line">    <span class="keywordflow">finally</span>:</div>
<div class="line">        viewer.cleanup()</div>
<div class="line">        del sm</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Shutdown ROS 2 if it&#39;s running</span></div>
<div class="line">    <span class="keywordflow">if</span> rclpy.ok():</div>
<div class="line">        rclpy.shutdown()</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md12"></a>
Publisher Demo (FSM + ROS 2 Publisher)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos publisher_demo.py</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">import</span> time</div>
<div class="line"><span class="keyword">import</span> rclpy</div>
<div class="line"><span class="keyword">from</span> std_msgs.msg <span class="keyword">import</span> Int32</div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> yasmin</div>
<div class="line"><span class="keyword">from</span> yasmin <span class="keyword">import</span> CbState, StateMachine, Blackboard</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> PublisherState, set_ros_loggers</div>
<div class="line"><span class="keyword">from</span> <a class="code hl_namespace" href="namespaceyasmin__ros_1_1basic__outcomes.html">yasmin_ros.basic_outcomes</a> <span class="keyword">import</span> SUCCEED</div>
<div class="line"><span class="keyword">from</span> yasmin_viewer <span class="keyword">import</span> YasminViewerPub</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classPublishIntState.html">PublishIntState</a>(<a class="code hl_function" href="classyasmin__ros_1_1PublisherState.html#a5e50083f85017666c10b227622dfefdc">PublisherState</a>):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    PublishIntState is a YASMIN ROS publisher state that sends incrementing integers</span></div>
<div class="line"><span class="stringliteral">    to the &#39;count&#39; topic using std_msgs.msg.Int32 messages.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    This state increments a counter on the blackboard and publishes it.</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>__init__(self):</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Initializes the PublishIntState with the topic &#39;count&#39; and a message creation callback.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        super().__init__(Int32, <span class="stringliteral">&quot;count&quot;</span>, self.create_int_msg)</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>create_int_msg(self, blackboard: Blackboard) -&gt; Int32:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Generates a std_msgs.msg.Int32 message with an incremented counter value.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The shared data store between states.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            Int32: A ROS message containing the updated counter.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        <span class="comment"># Get and increment the counter from the blackboard</span></div>
<div class="line">        counter = blackboard.get(<span class="stringliteral">&quot;counter&quot;</span>)</div>
<div class="line">        counter += 1</div>
<div class="line">        blackboard.set(<span class="stringliteral">&quot;counter&quot;</span>, counter)</div>
<div class="line"> </div>
<div class="line">        <span class="comment"># Log the message creation</span></div>
<div class="line">        yasmin.YASMIN_LOG_INFO(f<span class="stringliteral">&quot;Creating message {counter}&quot;</span>)</div>
<div class="line"> </div>
<div class="line">        <span class="comment"># Create and return the message</span></div>
<div class="line">        msg = Int32()</div>
<div class="line">        msg.data = counter</div>
<div class="line">        <span class="keywordflow">return</span> msg</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span><a class="code hl_function" href="publisher__demo_8cpp.html#a6fb402ab26a1b2ee540d9ec2f6138300">check_count</a>(blackboard: Blackboard) -&gt; str:</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Checks the current counter against a max threshold to determine state transition.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="stringliteral">        blackboard (Blackboard): The shared data store between states.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="stringliteral">        str: The outcome string (&#39;outcome1&#39; or &#39;outcome2&#39;).</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line">    <span class="comment"># Simulate processing time</span></div>
<div class="line">    time.sleep(1)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Retrieve the counter and max value from blackboard</span></div>
<div class="line">    count = blackboard.get(<span class="stringliteral">&quot;counter&quot;</span>)</div>
<div class="line">    max_count = blackboard.get(<span class="stringliteral">&quot;max_count&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    yasmin.YASMIN_LOG_INFO(f<span class="stringliteral">&quot;Checking count: {count}&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Determine and return the outcome based on the counter value</span></div>
<div class="line">    <span class="keywordflow">if</span> count &gt;= max_count:</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome1&quot;</span></div>
<div class="line">    <span class="keywordflow">else</span>:</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome2&quot;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span><a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>() -&gt; None:</div>
<div class="line">    yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;yasmin_monitor_demo&quot;</span>)</div>
<div class="line">    rclpy.init()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Configure YASMIN to use ROS-based logging</span></div>
<div class="line">    set_ros_loggers()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Create the state machine with &#39;SUCCEED&#39; as the terminal outcome</span></div>
<div class="line">    sm = StateMachine([SUCCEED], handle_sigint=<span class="keyword">True</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Add the publishing state which loops until the condition is met</span></div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;PUBLISHING_INT&quot;</span>,</div>
<div class="line">        <a class="code hl_class" href="classPublishIntState.html">PublishIntState</a>(),</div>
<div class="line">        {</div>
<div class="line">            SUCCEED: <span class="stringliteral">&quot;CHECKING_COUNTS&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Add the conditional check state</span></div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;CHECKING_COUNTS&quot;</span>,</div>
<div class="line">        CbState([<span class="stringliteral">&quot;outcome1&quot;</span>, <span class="stringliteral">&quot;outcome2&quot;</span>], check_count),</div>
<div class="line">        {</div>
<div class="line">            <span class="stringliteral">&quot;outcome1&quot;</span>: SUCCEED,</div>
<div class="line">            <span class="stringliteral">&quot;outcome2&quot;</span>: <span class="stringliteral">&quot;PUBLISHING_INT&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Launch YASMIN Viewer publisher for state visualization</span></div>
<div class="line">    viewer = YasminViewerPub(sm, <span class="stringliteral">&quot;YASMIN_PUBLISHER_DEMO&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Initialize blackboard with counter values</span></div>
<div class="line">    blackboard = Blackboard()</div>
<div class="line">    blackboard.set(<span class="stringliteral">&quot;counter&quot;</span>, 0)</div>
<div class="line">    blackboard.set(<span class="stringliteral">&quot;max_count&quot;</span>, 10)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Execute the FSM</span></div>
<div class="line">    <span class="keywordflow">try</span>:</div>
<div class="line">        outcome = sm()</div>
<div class="line">        yasmin.YASMIN_LOG_INFO(outcome)</div>
<div class="line">    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">        yasmin.YASMIN_LOG_WARN(e)</div>
<div class="line">    <span class="keywordflow">finally</span>:</div>
<div class="line">        viewer.cleanup()</div>
<div class="line">        del sm</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Shutdown ROS 2 if it&#39;s running</span></div>
<div class="line">    <span class="keywordflow">if</span> rclpy.ok():</div>
<div class="line">        rclpy.shutdown()</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
<div class="ttc" id="aclassPublishIntState_html"><div class="ttname"><a href="classPublishIntState.html">PublishIntState</a></div><div class="ttdoc">A state that publishes ints.</div><div class="ttdef"><b>Definition</b> publisher_demo.cpp:42</div></div>
<div class="ttc" id="aclassyasmin__ros_1_1PublisherState_html_a5e50083f85017666c10b227622dfefdc"><div class="ttname"><a href="classyasmin__ros_1_1PublisherState.html#a5e50083f85017666c10b227622dfefdc">yasmin_ros::PublisherState&lt; std_msgs::msg::Int32 &gt;::PublisherState</a></div><div class="ttdeci">PublisherState(const std::string &amp;topic_name, CreateMessageHandler create_message_handler, rclcpp::QoS qos=10, rclcpp::CallbackGroup::SharedPtr callback_group=nullptr)</div><div class="ttdef"><b>Definition</b> publisher_state.hpp:56</div></div>
<div class="ttc" id="apublisher__demo_8cpp_html_a6fb402ab26a1b2ee540d9ec2f6138300"><div class="ttname"><a href="publisher__demo_8cpp.html#a6fb402ab26a1b2ee540d9ec2f6138300">check_count</a></div><div class="ttdeci">std::string check_count(std::shared_ptr&lt; yasmin::Blackboard &gt; blackboard)</div><div class="ttdoc">Check the count in the blackboard and return an outcome based on it.</div><div class="ttdef"><b>Definition</b> publisher_demo.cpp:87</div></div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md13"></a>
Monitor Demo (FSM + ROS 2 Subscriber)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos monitor_demo.py</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">import</span> rclpy</div>
<div class="line"><span class="keyword">from</span> rclpy.qos <span class="keyword">import</span> qos_profile_sensor_data</div>
<div class="line"><span class="keyword">from</span> nav_msgs.msg <span class="keyword">import</span> Odometry</div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> yasmin</div>
<div class="line"><span class="keyword">from</span> yasmin <span class="keyword">import</span> Blackboard, StateMachine</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> MonitorState</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> set_ros_loggers</div>
<div class="line"><span class="keyword">from</span> <a class="code hl_namespace" href="namespaceyasmin__ros_1_1basic__outcomes.html">yasmin_ros.basic_outcomes</a> <span class="keyword">import</span> TIMEOUT</div>
<div class="line"><span class="keyword">from</span> yasmin_viewer <span class="keyword">import</span> YasminViewerPub</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classPrintOdometryState.html">PrintOdometryState</a>(<a class="code hl_function" href="classyasmin__ros_1_1MonitorState.html#ac37eb81dc449d9f7f53948c0211676a0">MonitorState</a>):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    MonitorState subclass to handle Odometry messages.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    This state monitors Odometry messages from the specified ROS topic,</span></div>
<div class="line"><span class="stringliteral">    logging them and transitioning based on the number of messages received.</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>__init__(self, times: int) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Initializes the PrintOdometryState.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            times (int): The number of Odometry messages to monitor before</span></div>
<div class="line"><span class="stringliteral">                         transitioning to the next outcome.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        super().__init__(</div>
<div class="line">            Odometry,  <span class="comment"># msg type</span></div>
<div class="line">            <span class="stringliteral">&quot;odom&quot;</span>,  <span class="comment"># topic name</span></div>
<div class="line">            [<span class="stringliteral">&quot;outcome1&quot;</span>, <span class="stringliteral">&quot;outcome2&quot;</span>],  <span class="comment"># outcomes</span></div>
<div class="line">            self.monitor_handler,  <span class="comment"># monitor handler callback</span></div>
<div class="line">            qos=qos_profile_sensor_data,  <span class="comment"># qos for the topic subscription</span></div>
<div class="line">            msg_queue=10,  <span class="comment"># queue for the monitor handler callback</span></div>
<div class="line">            timeout=10,  <span class="comment"># timeout to wait for messages in seconds</span></div>
<div class="line">        )</div>
<div class="line">        self.times = times</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>monitor_handler(self, blackboard: Blackboard, msg: Odometry) -&gt; str:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Handles incoming Odometry messages.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        This method is called whenever a new Odometry message is received.</span></div>
<div class="line"><span class="stringliteral">        It logs the message, decrements the count of messages to process,</span></div>
<div class="line"><span class="stringliteral">        and determines the next state outcome.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The shared data storage for states.</span></div>
<div class="line"><span class="stringliteral">            msg (Odometry): The incoming Odometry message.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            str: The next state outcome, either &quot;outcome1&quot; to continue</span></div>
<div class="line"><span class="stringliteral">                 monitoring or &quot;outcome2&quot; to transition to the next state.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Exceptions:</span></div>
<div class="line"><span class="stringliteral">            None</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        yasmin.YASMIN_LOG_INFO(msg)</div>
<div class="line"> </div>
<div class="line">        self.times -= 1</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> self.times &lt;= 0:</div>
<div class="line">            <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome2&quot;</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome1&quot;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span><a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>() -&gt; None:</div>
<div class="line">    yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;yasmin_monitor_demo&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Initialize ROS 2</span></div>
<div class="line">    rclpy.init()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Set ROS 2 logs</span></div>
<div class="line">    set_ros_loggers()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Create a finite state machine (FSM)</span></div>
<div class="line">    sm = StateMachine(outcomes=[<span class="stringliteral">&quot;outcome4&quot;</span>], handle_sigint=<span class="keyword">True</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Add states to the FSM</span></div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;PRINTING_ODOM&quot;</span>,</div>
<div class="line">        <a class="code hl_class" href="classPrintOdometryState.html">PrintOdometryState</a>(5),</div>
<div class="line">        transitions={</div>
<div class="line">            <span class="stringliteral">&quot;outcome1&quot;</span>: <span class="stringliteral">&quot;PRINTING_ODOM&quot;</span>,</div>
<div class="line">            <span class="stringliteral">&quot;outcome2&quot;</span>: <span class="stringliteral">&quot;outcome4&quot;</span>,</div>
<div class="line">            TIMEOUT: <span class="stringliteral">&quot;outcome4&quot;</span>,</div>
<div class="line">            CANCEL: <span class="stringliteral">&quot;outcome4&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Publish FSM information</span></div>
<div class="line">    viewer = YasminViewerPub(sm, <span class="stringliteral">&quot;YASMIN_MONITOR_DEMO&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Execute the FSM</span></div>
<div class="line">    <span class="keywordflow">try</span>:</div>
<div class="line">        outcome = sm()</div>
<div class="line">        yasmin.YASMIN_LOG_INFO(outcome)</div>
<div class="line">    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">        yasmin.YASMIN_LOG_WARN(e)</div>
<div class="line">    <span class="keywordflow">finally</span>:</div>
<div class="line">        viewer.cleanup()</div>
<div class="line">        del sm</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Shutdown ROS 2 if it&#39;s running</span></div>
<div class="line">    <span class="keywordflow">if</span> rclpy.ok():</div>
<div class="line">        rclpy.shutdown()</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
<div class="ttc" id="aclassPrintOdometryState_html"><div class="ttname"><a href="classPrintOdometryState.html">PrintOdometryState</a></div><div class="ttdoc">A state that monitors odometry data and transitions based on a specified count.</div><div class="ttdef"><b>Definition</b> monitor_demo.cpp:43</div></div>
<div class="ttc" id="aclassyasmin__ros_1_1MonitorState_html_ac37eb81dc449d9f7f53948c0211676a0"><div class="ttname"><a href="classyasmin__ros_1_1MonitorState.html#ac37eb81dc449d9f7f53948c0211676a0">yasmin_ros::MonitorState&lt; nav_msgs::msg::Odometry &gt;::MonitorState</a></div><div class="ttdeci">MonitorState(const std::string &amp;topic_name, const std::set&lt; std::string &gt; &amp;outcomes, MonitorHandler monitor_handler, rclcpp::QoS qos=10, int msg_queue=10, int timeout=-1, int maximum_retry=3)</div><div class="ttdef"><b>Definition</b> monitor_state.hpp:68</div></div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md14"></a>
Service Demo (FSM + ROS 2 Service Client)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos add_two_ints_server</div>
</div><!-- fragment --><div class="fragment"><div class="line">ros2 run yasmin_demos service_client_demo.py</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">import</span> rclpy</div>
<div class="line"><span class="keyword">from</span> example_interfaces.srv <span class="keyword">import</span> AddTwoInts</div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> yasmin</div>
<div class="line"><span class="keyword">from</span> yasmin <span class="keyword">import</span> CbState, Blackboard, StateMachine</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> ServiceState</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> set_ros_loggers</div>
<div class="line"><span class="keyword">from</span> <a class="code hl_namespace" href="namespaceyasmin__ros_1_1basic__outcomes.html">yasmin_ros.basic_outcomes</a> <span class="keyword">import</span> SUCCEED, ABORT</div>
<div class="line"><span class="keyword">from</span> yasmin_viewer <span class="keyword">import</span> YasminViewerPub</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classAddTwoIntsState.html">AddTwoIntsState</a>(<a class="code hl_function" href="classyasmin__ros_1_1ServiceState.html#ad0f500a0f2fc16461cf19c1213d761a2">ServiceState</a>):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    A state that calls the AddTwoInts service to add two integers.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    This class is a state in a finite state machine that sends a request</span></div>
<div class="line"><span class="stringliteral">    to the AddTwoInts service, retrieves the response, and updates the</span></div>
<div class="line"><span class="stringliteral">    blackboard with the result.</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>__init__(self) -&gt; None:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Initializes the AddTwoIntsState.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Calls the parent constructor with the specific service type,</span></div>
<div class="line"><span class="stringliteral">        service name, request handler, outcomes, and response handler.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        super().__init__(</div>
<div class="line">            AddTwoInts,  <span class="comment"># srv type</span></div>
<div class="line">            <span class="stringliteral">&quot;/add_two_ints&quot;</span>,  <span class="comment"># service name</span></div>
<div class="line">            self.create_request_handler,  <span class="comment"># cb to create the request</span></div>
<div class="line">            [<span class="stringliteral">&quot;outcome1&quot;</span>],  <span class="comment"># outcomes. Includes (SUCCEED, ABORT)</span></div>
<div class="line">            self.response_handler,  <span class="comment"># cb to process the response</span></div>
<div class="line">        )</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>create_request_handler(self, blackboard: Blackboard) -&gt; AddTwoInts.Request:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Creates the service request from the blackboard data.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The blackboard containing the input values.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            AddTwoInts.Request: The request object populated with values from the blackboard.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        req = AddTwoInts.Request()</div>
<div class="line">        req.a = blackboard[<span class="stringliteral">&quot;a&quot;</span>]</div>
<div class="line">        req.b = blackboard[<span class="stringliteral">&quot;b&quot;</span>]</div>
<div class="line">        <span class="keywordflow">return</span> req</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>response_handler(</div>
<div class="line">        self, blackboard: Blackboard, response: AddTwoInts.Response</div>
<div class="line">    ) -&gt; str:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Processes the response from the AddTwoInts service.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Updates the blackboard with the sum result from the response.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The blackboard to update with the sum.</span></div>
<div class="line"><span class="stringliteral">            response (AddTwoInts.Response): The response from the service call.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            str: The outcome of the operation, which is &quot;outcome1&quot;.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        blackboard[<span class="stringliteral">&quot;sum&quot;</span>] = response.sum</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome1&quot;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span><a class="code hl_function" href="service__client__demo_8cpp.html#a73d2bd5c99568a599143915a2483201d">set_ints</a>(blackboard: Blackboard) -&gt; str:</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Sets the integer values in the blackboard.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    This function initializes the blackboard with two integer values to be added.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="stringliteral">        blackboard (Blackboard): The blackboard to update with integer values.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="stringliteral">        str: The outcome of the operation, which is SUCCEED.</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line">    blackboard[<span class="stringliteral">&quot;a&quot;</span>] = 10</div>
<div class="line">    blackboard[<span class="stringliteral">&quot;b&quot;</span>] = 5</div>
<div class="line">    <span class="keywordflow">return</span> SUCCEED</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span><a class="code hl_function" href="service__client__demo_8cpp.html#accc90ce177b13fe70630560b1662ecac">print_sum</a>(blackboard: Blackboard) -&gt; str:</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Logs the sum value from the blackboard.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    This function retrieves the sum from the blackboard and logs it.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="stringliteral">        blackboard (Blackboard): The blackboard from which to retrieve the sum.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="stringliteral">        str: The outcome of the operation, which is SUCCEED.</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line">    yasmin.YASMIN_LOG_INFO(f<span class="stringliteral">&quot;Sum: {blackboard[&#39;sum&#39;]}&quot;</span>)</div>
<div class="line">    <span class="keywordflow">return</span> SUCCEED</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span><a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>() -&gt; None:</div>
<div class="line">    yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;yasmin_service_client_demo&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Init ROS 2</span></div>
<div class="line">    rclpy.init()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Set ROS 2 logs</span></div>
<div class="line">    set_ros_loggers()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Create a FSM</span></div>
<div class="line">    sm = StateMachine(outcomes=[<span class="stringliteral">&quot;outcome4&quot;</span>], handle_sigint=<span class="keyword">True</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Add states</span></div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;SETTING_INTS&quot;</span>,</div>
<div class="line">        CbState([SUCCEED], set_ints),</div>
<div class="line">        transitions={SUCCEED: <span class="stringliteral">&quot;ADD_TWO_INTS&quot;</span>},</div>
<div class="line">    )</div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;ADD_TWO_INTS&quot;</span>,</div>
<div class="line">        <a class="code hl_class" href="classAddTwoIntsState.html">AddTwoIntsState</a>(),</div>
<div class="line">        transitions={</div>
<div class="line">            <span class="stringliteral">&quot;outcome1&quot;</span>: <span class="stringliteral">&quot;PRINTING_SUM&quot;</span>,</div>
<div class="line">            SUCCEED: <span class="stringliteral">&quot;outcome4&quot;</span>,</div>
<div class="line">            ABORT: <span class="stringliteral">&quot;outcome4&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;PRINTING_SUM&quot;</span>,</div>
<div class="line">        CbState([SUCCEED], print_sum),</div>
<div class="line">        transitions={</div>
<div class="line">            SUCCEED: <span class="stringliteral">&quot;outcome4&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Publish FSM info</span></div>
<div class="line">    viewer = YasminViewerPub(sm, <span class="stringliteral">&quot;YASMIN_SERVICE_CLIENT_DEMO&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Execute the FSM</span></div>
<div class="line">    <span class="keywordflow">try</span>:</div>
<div class="line">        outcome = sm()</div>
<div class="line">        yasmin.YASMIN_LOG_INFO(outcome)</div>
<div class="line">    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">        yasmin.YASMIN_LOG_WARN(e)</div>
<div class="line">    <span class="keywordflow">finally</span>:</div>
<div class="line">        viewer.cleanup()</div>
<div class="line">        del sm</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Shutdown ROS 2 if it&#39;s running</span></div>
<div class="line">    <span class="keywordflow">if</span> rclpy.ok():</div>
<div class="line">        rclpy.shutdown()</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
<div class="ttc" id="aclassAddTwoIntsState_html"><div class="ttname"><a href="classAddTwoIntsState.html">AddTwoIntsState</a></div><div class="ttdoc">State for calling the AddTwoInts service in ROS 2.</div><div class="ttdef"><b>Definition</b> service_client_demo.cpp:72</div></div>
<div class="ttc" id="aclassyasmin__ros_1_1ServiceState_html_ad0f500a0f2fc16461cf19c1213d761a2"><div class="ttname"><a href="classyasmin__ros_1_1ServiceState.html#ad0f500a0f2fc16461cf19c1213d761a2">yasmin_ros::ServiceState&lt; example_interfaces::srv::AddTwoInts &gt;::ServiceState</a></div><div class="ttdeci">ServiceState(const std::string &amp;srv_name, CreateRequestHandler create_request_handler, int wait_timeout=-1, int response_timeout=-1, int maximum_retry=3)</div><div class="ttdef"><b>Definition</b> service_state.hpp:74</div></div>
<div class="ttc" id="aservice__client__demo_8cpp_html_a73d2bd5c99568a599143915a2483201d"><div class="ttname"><a href="service__client__demo_8cpp.html#a73d2bd5c99568a599143915a2483201d">set_ints</a></div><div class="ttdeci">std::string set_ints(std::shared_ptr&lt; yasmin::Blackboard &gt; blackboard)</div><div class="ttdoc">Sets two integer values in the blackboard.</div><div class="ttdef"><b>Definition</b> service_client_demo.cpp:43</div></div>
<div class="ttc" id="aservice__client__demo_8cpp_html_accc90ce177b13fe70630560b1662ecac"><div class="ttname"><a href="service__client__demo_8cpp.html#accc90ce177b13fe70630560b1662ecac">print_sum</a></div><div class="ttdeci">std::string print_sum(std::shared_ptr&lt; yasmin::Blackboard &gt; blackboard)</div><div class="ttdoc">Prints the sum stored in the blackboard.</div><div class="ttdef"><b>Definition</b> service_client_demo.cpp:57</div></div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md15"></a>
Action Demo (FSM + ROS 2 Action)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos fibonacci_action_server</div>
</div><!-- fragment --><div class="fragment"><div class="line">ros2 run yasmin_demos action_client_demo.py</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">import</span> rclpy</div>
<div class="line"><span class="keyword">from</span> example_interfaces.action <span class="keyword">import</span> Fibonacci</div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> yasmin</div>
<div class="line"><span class="keyword">from</span> yasmin <span class="keyword">import</span> CbState, Blackboard, StateMachine</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> ActionState</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> set_ros_loggers</div>
<div class="line"><span class="keyword">from</span> <a class="code hl_namespace" href="namespaceyasmin__ros_1_1basic__outcomes.html">yasmin_ros.basic_outcomes</a> <span class="keyword">import</span> SUCCEED, ABORT, CANCEL</div>
<div class="line"><span class="keyword">from</span> yasmin_viewer <span class="keyword">import</span> YasminViewerPub</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classFibonacciState.html">FibonacciState</a>(<a class="code hl_function" href="classyasmin__ros_1_1ActionState.html#a9b01b7c94f4f4b93786e4d3dbecd5264">ActionState</a>):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Class representing the state of the Fibonacci action.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Inherits from ActionState and implements methods to handle the</span></div>
<div class="line"><span class="stringliteral">    Fibonacci action in a finite state machine.</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>__init__(self) -&gt; None:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Initializes the FibonacciState.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Sets up the action type and the action name for the Fibonacci</span></div>
<div class="line"><span class="stringliteral">        action. Initializes goal, response handler, and feedback</span></div>
<div class="line"><span class="stringliteral">        processing callbacks.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        super().__init__(</div>
<div class="line">            Fibonacci,  <span class="comment"># action type</span></div>
<div class="line">            <span class="stringliteral">&quot;/fibonacci&quot;</span>,  <span class="comment"># action name</span></div>
<div class="line">            self.create_goal_handler,  <span class="comment"># callback to create the goal</span></div>
<div class="line">            <span class="keywordtype">None</span>,  <span class="comment"># outcomes. Includes (SUCCEED, ABORT, CANCEL)</span></div>
<div class="line">            self.response_handler,  <span class="comment"># callback to process the response</span></div>
<div class="line">            self.print_feedback,  <span class="comment"># callback to process the feedback</span></div>
<div class="line">        )</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>create_goal_handler(self, blackboard: Blackboard) -&gt; Fibonacci.Goal:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Creates the goal for the Fibonacci action.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        This method retrieves the input value from the blackboard and</span></div>
<div class="line"><span class="stringliteral">        populates the Fibonacci goal.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The blackboard containing the state</span></div>
<div class="line"><span class="stringliteral">            information.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            Fibonacci.Goal: The populated goal object for the Fibonacci action.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Raises:</span></div>
<div class="line"><span class="stringliteral">            KeyError: If the expected key is not present in the blackboard.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        goal = Fibonacci.Goal()</div>
<div class="line">        goal.order = blackboard[<span class="stringliteral">&quot;n&quot;</span>]  <span class="comment"># Retrieve the input value &#39;n&#39; from the blackboard</span></div>
<div class="line">        <span class="keywordflow">return</span> goal</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>response_handler(self, blackboard: Blackboard, response: Fibonacci.Result) -&gt; str:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Handles the response from the Fibonacci action.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        This method processes the result of the Fibonacci action and</span></div>
<div class="line"><span class="stringliteral">        stores it in the blackboard.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The blackboard to store the result.</span></div>
<div class="line"><span class="stringliteral">            response (Fibonacci.Result): The result object from the Fibonacci action.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            str: Outcome of the operation, typically SUCCEED.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Raises:</span></div>
<div class="line"><span class="stringliteral">            None</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        blackboard[<span class="stringliteral">&quot;fibo_res&quot;</span>] = (</div>
<div class="line">            response.sequence</div>
<div class="line">        )  <span class="comment"># Store the result sequence in the blackboard</span></div>
<div class="line">        <span class="keywordflow">return</span> SUCCEED</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>print_feedback(</div>
<div class="line">        self, blackboard: Blackboard, feedback: Fibonacci.Feedback</div>
<div class="line">    ) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Prints feedback from the Fibonacci action.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        This method logs the partial sequence received during the action.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The blackboard (not used in this method).</span></div>
<div class="line"><span class="stringliteral">            feedback (Fibonacci.Feedback): The feedback object from the Fibonacci action.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            None</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Raises:</span></div>
<div class="line"><span class="stringliteral">            None</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        yasmin.YASMIN_LOG_INFO(f<span class="stringliteral">&quot;Received feedback: {list(feedback.sequence)}&quot;</span>)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span><a class="code hl_function" href="action__client__demo_8cpp.html#a15c57adaf02057eb95645e20dec27f4e">print_result</a>(blackboard: Blackboard) -&gt; str:</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Prints the result of the Fibonacci action.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    This function logs the final result stored in the blackboard.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="stringliteral">        blackboard (Blackboard): The blackboard containing the result.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="stringliteral">        str: Outcome of the operation, typically SUCCEED.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Raises:</span></div>
<div class="line"><span class="stringliteral">        None</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line">    yasmin.YASMIN_LOG_INFO(f<span class="stringliteral">&quot;Result: {blackboard[&#39;fibo_res&#39;]}&quot;</span>)</div>
<div class="line">    <span class="keywordflow">return</span> SUCCEED</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span><a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>() -&gt; None:</div>
<div class="line">    yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;yasmin_action_client_demo&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Initialize ROS 2</span></div>
<div class="line">    rclpy.init()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Set up ROS 2 logs</span></div>
<div class="line">    set_ros_loggers()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Create a finite state machine (FSM)</span></div>
<div class="line">    sm = StateMachine(outcomes=[<span class="stringliteral">&quot;outcome4&quot;</span>], handle_sigint=<span class="keyword">True</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Add states to the FSM</span></div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;CALLING_FIBONACCI&quot;</span>,</div>
<div class="line">        <a class="code hl_class" href="classFibonacciState.html">FibonacciState</a>(),</div>
<div class="line">        transitions={</div>
<div class="line">            SUCCEED: <span class="stringliteral">&quot;PRINTING_RESULT&quot;</span>,</div>
<div class="line">            CANCEL: <span class="stringliteral">&quot;outcome4&quot;</span>,</div>
<div class="line">            ABORT: <span class="stringliteral">&quot;outcome4&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;PRINTING_RESULT&quot;</span>,</div>
<div class="line">        CbState([SUCCEED], print_result),</div>
<div class="line">        transitions={</div>
<div class="line">            SUCCEED: <span class="stringliteral">&quot;outcome4&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Publish FSM information</span></div>
<div class="line">    viewer = YasminViewerPub(sm, <span class="stringliteral">&quot;YASMIN_ACTION_CLIENT_DEMO&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Create an initial blackboard with the input value</span></div>
<div class="line">    blackboard = Blackboard()</div>
<div class="line">    blackboard[<span class="stringliteral">&quot;n&quot;</span>] = 10  <span class="comment"># Set the Fibonacci order to 10</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Execute the FSM</span></div>
<div class="line">    <span class="keywordflow">try</span>:</div>
<div class="line">        outcome = sm(blackboard)</div>
<div class="line">        yasmin.YASMIN_LOG_INFO(outcome)</div>
<div class="line">    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">        yasmin.YASMIN_LOG_WARN(e)</div>
<div class="line">    <span class="keywordflow">finally</span>:</div>
<div class="line">        viewer.cleanup()</div>
<div class="line">        del sm</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Shutdown ROS 2 if it&#39;s running</span></div>
<div class="line">    <span class="keywordflow">if</span> rclpy.ok():</div>
<div class="line">        rclpy.shutdown()</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
<div class="ttc" id="aaction__client__demo_8cpp_html_a15c57adaf02057eb95645e20dec27f4e"><div class="ttname"><a href="action__client__demo_8cpp.html#a15c57adaf02057eb95645e20dec27f4e">print_result</a></div><div class="ttdeci">std::string print_result(std::shared_ptr&lt; yasmin::Blackboard &gt; blackboard)</div><div class="ttdoc">Prints the result of the Fibonacci action.</div><div class="ttdef"><b>Definition</b> action_client_demo.cpp:45</div></div>
<div class="ttc" id="aclassFibonacciState_html"><div class="ttname"><a href="classFibonacciState.html">FibonacciState</a></div><div class="ttdoc">Represents the action state for the Fibonacci action.</div><div class="ttdef"><b>Definition</b> action_client_demo.cpp:71</div></div>
<div class="ttc" id="aclassyasmin__ros_1_1ActionState_html_a9b01b7c94f4f4b93786e4d3dbecd5264"><div class="ttname"><a href="classyasmin__ros_1_1ActionState.html#a9b01b7c94f4f4b93786e4d3dbecd5264">yasmin_ros::ActionState&lt; Fibonacci &gt;::ActionState</a></div><div class="ttdeci">ActionState(const std::string &amp;action_name, CreateGoalHandler create_goal_handler, const std::set&lt; std::string &gt; &amp;outcomes, int wait_timeout=-1, int response_timeout=-1, int maximum_retry=3)</div><div class="ttdef"><b>Definition</b> action_state.hpp:93</div></div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md16"></a>
Parameters Demo (FSM + ROS 2 Parameters)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos parameters_demo.py --ros-args -p max_counter:=5</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">import</span> time</div>
<div class="line"><span class="keyword">import</span> rclpy</div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> yasmin</div>
<div class="line"><span class="keyword">from</span> yasmin <span class="keyword">import</span> State, Blackboard, StateMachine</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> set_ros_loggers</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> GetParametersState</div>
<div class="line"><span class="keyword">from</span> <a class="code hl_namespace" href="namespaceyasmin__ros_1_1basic__outcomes.html">yasmin_ros.basic_outcomes</a> <span class="keyword">import</span> SUCCEED, ABORT</div>
<div class="line"><span class="keyword">from</span> yasmin_viewer <span class="keyword">import</span> YasminViewerPub</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Define the FooState class, inheriting from the State class</span></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classFooState.html">FooState</a>(State):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Represents the Foo state in the state machine.</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>__init__(self) -&gt; None:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Initializes the FooState instance, setting up the outcomes.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Outcomes:</span></div>
<div class="line"><span class="stringliteral">            outcome1: Indicates the state should continue to the Bar state.</span></div>
<div class="line"><span class="stringliteral">            outcome2: Indicates the state should finish execution and return.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        super().__init__([<span class="stringliteral">&quot;outcome1&quot;</span>, <span class="stringliteral">&quot;outcome2&quot;</span>])</div>
<div class="line">        self.counter = 0</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>execute(self, blackboard: Blackboard) -&gt; str:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Executes the logic for the Foo state.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The shared data structure for states.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            str: The outcome of the execution, which can be &quot;outcome1&quot; or &quot;outcome2&quot;.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Raises:</span></div>
<div class="line"><span class="stringliteral">            Exception: May raise exceptions related to state execution.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;Executing state FOO&quot;</span>)</div>
<div class="line">        time.sleep(3)  <span class="comment"># Simulate work by sleeping</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> self.counter &lt; blackboard[<span class="stringliteral">&quot;max_counter&quot;</span>]:</div>
<div class="line">            self.counter += 1</div>
<div class="line">            blackboard[<span class="stringliteral">&quot;foo_str&quot;</span>] = f<span class="stringliteral">&quot;{blackboard[&#39;counter_str&#39;]}: {self.counter}&quot;</span></div>
<div class="line">            <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome1&quot;</span></div>
<div class="line">        <span class="keywordflow">else</span>:</div>
<div class="line">            <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome2&quot;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Define the BarState class, inheriting from the State class</span></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classBarState.html">BarState</a>(State):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Represents the Bar state in the state machine.</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>__init__(self) -&gt; None:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Initializes the BarState instance, setting up the outcome.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Outcomes:</span></div>
<div class="line"><span class="stringliteral">            outcome3: Indicates the state should transition back to the Foo state.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        super().__init__(outcomes=[<span class="stringliteral">&quot;outcome3&quot;</span>])</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>execute(self, blackboard: Blackboard) -&gt; str:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Executes the logic for the Bar state.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The shared data structure for states.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            str: The outcome of the execution, which will always be &quot;outcome3&quot;.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Raises:</span></div>
<div class="line"><span class="stringliteral">            Exception: May raise exceptions related to state execution.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;Executing state BAR&quot;</span>)</div>
<div class="line">        time.sleep(3)  <span class="comment"># Simulate work by sleeping</span></div>
<div class="line"> </div>
<div class="line">        yasmin.YASMIN_LOG_INFO(blackboard[<span class="stringliteral">&quot;foo_str&quot;</span>])</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome3&quot;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span><a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>() -&gt; None:</div>
<div class="line">    yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;yasmin_parameters_demo&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Initialize ROS 2</span></div>
<div class="line">    rclpy.init()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Set ROS 2 loggers</span></div>
<div class="line">    set_ros_loggers()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Create a finite state machine (FSM)</span></div>
<div class="line">    sm = StateMachine(outcomes=[<span class="stringliteral">&quot;outcome4&quot;</span>], handle_sigint=<span class="keyword">True</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Add states to the FSM</span></div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;GETTING_PARAMETERS&quot;</span>,</div>
<div class="line">        GetParametersState(</div>
<div class="line">            parameters={</div>
<div class="line">                <span class="stringliteral">&quot;max_counter&quot;</span>: 3,</div>
<div class="line">                <span class="stringliteral">&quot;counter_str&quot;</span>: <span class="stringliteral">&quot;Counter&quot;</span>,</div>
<div class="line">            },</div>
<div class="line">        ),</div>
<div class="line">        transitions={</div>
<div class="line">            SUCCEED: <span class="stringliteral">&quot;FOO&quot;</span>,</div>
<div class="line">            ABORT: <span class="stringliteral">&quot;outcome4&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;FOO&quot;</span>,</div>
<div class="line">        <a class="code hl_class" href="classFooState.html">FooState</a>(),</div>
<div class="line">        transitions={</div>
<div class="line">            <span class="stringliteral">&quot;outcome1&quot;</span>: <span class="stringliteral">&quot;BAR&quot;</span>,</div>
<div class="line">            <span class="stringliteral">&quot;outcome2&quot;</span>: <span class="stringliteral">&quot;outcome4&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;BAR&quot;</span>,</div>
<div class="line">        <a class="code hl_class" href="classBarState.html">BarState</a>(),</div>
<div class="line">        transitions={</div>
<div class="line">            <span class="stringliteral">&quot;outcome3&quot;</span>: <span class="stringliteral">&quot;FOO&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Publish FSM information for visualization</span></div>
<div class="line">    viewer = YasminViewerPub(sm, <span class="stringliteral">&quot;YASMIN_PARAMETERS_DEMO&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Execute the FSM</span></div>
<div class="line">    <span class="keywordflow">try</span>:</div>
<div class="line">        outcome = sm()</div>
<div class="line">        yasmin.YASMIN_LOG_INFO(outcome)</div>
<div class="line">    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">        yasmin.YASMIN_LOG_WARN(e)</div>
<div class="line">    <span class="keywordflow">finally</span>:</div>
<div class="line">        viewer.cleanup()</div>
<div class="line">        del sm</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Shutdown ROS 2 if it&#39;s running</span></div>
<div class="line">    <span class="keywordflow">if</span> rclpy.ok():</div>
<div class="line">        rclpy.shutdown()</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md17"></a>
Factory Demo (Plugins)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<blockquote class="doxtable">
<p><b>Note:</b> When mixing Python and C++ states in the same state machine, they can communicate through the blackboard, but only with primitive data types: <code>int</code>, <code>float</code>, <code>bool</code>, and <code>string</code>. Complex objects or ROS messages cannot be directly shared between Python and C++ states. </p>
</blockquote>
<div class="fragment"><div class="line">ros2 run yasmin_demos factory_demo.py</div>
</div><!-- fragment --><div class="fragment"><div class="line">&lt;<span class="keywordtype">StateMachine</span> <span class="keyword">outcomes</span>=<span class="stringliteral">&quot;outcome4&quot;</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">State</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;Foo&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;cpp&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;yasmin_demos/FooState&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Transition</span> <span class="keyword">from</span>=<span class="stringliteral">&quot;outcome1&quot;</span> <span class="keyword">to</span>=<span class="stringliteral">&quot;Bar&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Transition</span> <span class="keyword">from</span>=<span class="stringliteral">&quot;outcome2&quot;</span> <span class="keyword">to</span>=<span class="stringliteral">&quot;outcome4&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">State</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">State</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;Bar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;py&quot;</span> <span class="keyword">module</span>=<span class="stringliteral">&quot;yasmin_demos.bar_state&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;BarState&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Transition</span> <span class="keyword">from</span>=<span class="stringliteral">&quot;outcome3&quot;</span> <span class="keyword">to</span>=<span class="stringliteral">&quot;Foo&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">State</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">StateMachine</span>&gt;</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">import</span> os</div>
<div class="line"><span class="keyword">import</span> rclpy</div>
<div class="line"><span class="keyword">import</span> yasmin</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> set_ros_loggers</div>
<div class="line"><span class="keyword">from</span> yasmin_viewer <span class="keyword">import</span> YasminViewerPub</div>
<div class="line"><span class="keyword">from</span> yasmin_factory <span class="keyword">import</span> YasminFactory</div>
<div class="line"><span class="keyword">from</span> ament_index_python <span class="keyword">import</span> get_package_share_directory</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span><a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>() -&gt; None:</div>
<div class="line">    yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;yasmin_demo&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Initialize ROS 2</span></div>
<div class="line">    rclpy.init()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Set ROS 2 loggers</span></div>
<div class="line">    set_ros_loggers()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Create a finite state machine (FSM)</span></div>
<div class="line">    factory = YasminFactory()</div>
<div class="line">    sm = factory.create_sm_from_file(</div>
<div class="line">        os.path.join(</div>
<div class="line">            get_package_share_directory(<span class="stringliteral">&quot;yasmin_demos&quot;</span>), <span class="stringliteral">&quot;state_machines&quot;</span>, <span class="stringliteral">&quot;demo_1.xml&quot;</span></div>
<div class="line">        )</div>
<div class="line">    )</div>
<div class="line">    sm.set_sigint_handler(<span class="keyword">True</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Publish FSM information for visualization</span></div>
<div class="line">    viewer = YasminViewerPub(sm, <span class="stringliteral">&quot;plugin_demo&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Execute the FSM</span></div>
<div class="line">    <span class="keywordflow">try</span>:</div>
<div class="line">        outcome = sm()</div>
<div class="line">        yasmin.YASMIN_LOG_INFO(outcome)</div>
<div class="line">    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">        yasmin.YASMIN_LOG_WARN(e)</div>
<div class="line">    <span class="keywordflow">finally</span>:</div>
<div class="line">        viewer.cleanup()</div>
<div class="line">        del sm</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Shutdown ROS 2 if it&#39;s running</span></div>
<div class="line">    <span class="keywordflow">if</span> rclpy.ok():</div>
<div class="line">        rclpy.shutdown()</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md18"></a>
Nav2 Demo (Hierarchical FSM + ROS 2 Action)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line"><span class="keyword">import</span> random</div>
<div class="line"><span class="keyword">import</span> rclpy</div>
<div class="line"><span class="keyword">from</span> geometry_msgs.msg <span class="keyword">import</span> Pose</div>
<div class="line"><span class="keyword">from</span> nav2_msgs.action <span class="keyword">import</span> NavigateToPose</div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> yasmin</div>
<div class="line"><span class="keyword">from</span> yasmin <span class="keyword">import</span> CbState, Blackboard, StateMachine</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> ActionState</div>
<div class="line"><span class="keyword">from</span> yasmin_ros <span class="keyword">import</span> set_ros_loggers</div>
<div class="line"><span class="keyword">from</span> <a class="code hl_namespace" href="namespaceyasmin__ros_1_1basic__outcomes.html">yasmin_ros.basic_outcomes</a> <span class="keyword">import</span> SUCCEED, ABORT, CANCEL</div>
<div class="line"><span class="keyword">from</span> yasmin_viewer <span class="keyword">import</span> YasminViewerPub</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Constants for state outcomes</span></div>
<div class="line">HAS_NEXT = <span class="stringliteral">&quot;has_next&quot;</span>  </div>
<div class="line">END = <span class="stringliteral">&quot;end&quot;</span>  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Nav2State(ActionState):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    ActionState for navigating to a specified pose using ROS 2 Navigation.</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>__init__(self) -&gt; None:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Initializes the Nav2State.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Calls the parent constructor to set up the action with:</span></div>
<div class="line"><span class="stringliteral">        - Action type: NavigateToPose</span></div>
<div class="line"><span class="stringliteral">        - Action name: /navigate_to_pose</span></div>
<div class="line"><span class="stringliteral">        - Callback for goal creation: create_goal_handler</span></div>
<div class="line"><span class="stringliteral">        - Outcomes: None, since it will use default outcomes (SUCCEED, ABORT, CANCEL)</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        super().__init__(</div>
<div class="line">            NavigateToPose,  <span class="comment"># action type</span></div>
<div class="line">            <span class="stringliteral">&quot;/navigate_to_pose&quot;</span>,  <span class="comment"># action name</span></div>
<div class="line">            self.create_goal_handler,  <span class="comment"># callback to create the goal</span></div>
<div class="line">            <span class="keywordtype">None</span>,  <span class="comment"># outcomes</span></div>
<div class="line">            <span class="keywordtype">None</span>,  <span class="comment"># callback to process the response</span></div>
<div class="line">        )</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>create_goal_handler(self, blackboard: Blackboard) -&gt; NavigateToPose.Goal:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">        Creates a goal for navigation based on the current pose in the blackboard.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="stringliteral">            blackboard (Blackboard): The blackboard instance holding current state data.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="stringliteral">            NavigateToPose.Goal: The constructed goal for the navigation action.</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line">        goal = NavigateToPose.Goal()</div>
<div class="line">        goal.pose.pose = blackboard[<span class="stringliteral">&quot;pose&quot;</span>]</div>
<div class="line">        goal.pose.header.frame_id = <span class="stringliteral">&quot;map&quot;</span>  <span class="comment"># Set the reference frame to &#39;map&#39;</span></div>
<div class="line">        <span class="keywordflow">return</span> goal</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span>create_waypoints(blackboard: Blackboard) -&gt; str:</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Initializes waypoints in the blackboard for navigation.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="stringliteral">        blackboard (Blackboard): The blackboard instance to store waypoints.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="stringliteral">        str: Outcome indicating success (SUCCEED).</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line">    blackboard[<span class="stringliteral">&quot;waypoints&quot;</span>] = {</div>
<div class="line">        <span class="stringliteral">&quot;entrance&quot;</span>: [1.25, 6.30, -0.78, 0.67],</div>
<div class="line">        <span class="stringliteral">&quot;bathroom&quot;</span>: [4.89, 1.64, 0.0, 1.0],</div>
<div class="line">        <span class="stringliteral">&quot;livingroom&quot;</span>: [1.55, 4.03, -0.69, 0.72],</div>
<div class="line">        <span class="stringliteral">&quot;kitchen&quot;</span>: [3.79, 6.77, 0.99, 0.12],</div>
<div class="line">        <span class="stringliteral">&quot;bedroom&quot;</span>: [7.50, 4.89, 0.76, 0.65],</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> SUCCEED</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span>take_random_waypoint(blackboard: Blackboard) -&gt; str:</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Selects a random set of waypoints from the available waypoints.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="stringliteral">        blackboard (Blackboard): The blackboard instance to store random waypoints.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="stringliteral">        str: Outcome indicating success (SUCCEED).</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line">    blackboard[<span class="stringliteral">&quot;random_waypoints&quot;</span>] = random.sample(</div>
<div class="line">        list(blackboard[<span class="stringliteral">&quot;waypoints&quot;</span>].keys()), blackboard[<span class="stringliteral">&quot;waypoints_num&quot;</span>]</div>
<div class="line">    )</div>
<div class="line">    <span class="keywordflow">return</span> SUCCEED</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span>get_next_waypoint(blackboard: Blackboard) -&gt; str:</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    Retrieves the next waypoint from the list of random waypoints.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Updates the blackboard with the pose of the next waypoint.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="stringliteral">        blackboard (Blackboard): The blackboard instance holding current state data.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="stringliteral">        str: Outcome indicating whether there is a next waypoint (HAS_NEXT) or if</span></div>
<div class="line"><span class="stringliteral">             navigation is complete (END).</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line">    <span class="keywordflow">if</span> <span class="keywordflow">not</span> blackboard[<span class="stringliteral">&quot;random_waypoints&quot;</span>]:</div>
<div class="line">        <span class="keywordflow">return</span> END</div>
<div class="line"> </div>
<div class="line">    wp_name = blackboard[<span class="stringliteral">&quot;random_waypoints&quot;</span>].pop(0)  <span class="comment"># Get the next waypoint name</span></div>
<div class="line">    wp = blackboard[<span class="stringliteral">&quot;waypoints&quot;</span>][wp_name]  <span class="comment"># Get the waypoint coordinates</span></div>
<div class="line"> </div>
<div class="line">    pose = Pose()</div>
<div class="line">    pose.position.x = wp[0]</div>
<div class="line">    pose.position.y = wp[1]</div>
<div class="line">    pose.orientation.z = wp[2]</div>
<div class="line">    pose.orientation.w = wp[3]</div>
<div class="line"> </div>
<div class="line">    blackboard[<span class="stringliteral">&quot;pose&quot;</span>] = pose  <span class="comment"># Update blackboard with new pose</span></div>
<div class="line">    blackboard[<span class="stringliteral">&quot;text&quot;</span>] = f<span class="stringliteral">&quot;I have reached waypoint {wp_name}&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> HAS_NEXT</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span><a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>() -&gt; None:</div>
<div class="line">    yasmin.YASMIN_LOG_INFO(<span class="stringliteral">&quot;yasmin_nav2_demo&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Initialize ROS 2</span></div>
<div class="line">    rclpy.init()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Set ROS 2 loggers for debugging</span></div>
<div class="line">    set_ros_loggers()</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Create state machines</span></div>
<div class="line">    sm = StateMachine(outcomes=[SUCCEED, ABORT, CANCEL], handle_sigint=<span class="keyword">True</span>)</div>
<div class="line">    nav_sm = StateMachine(outcomes=[SUCCEED, ABORT, CANCEL])</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Add states to the state machine</span></div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;CREATING_WAYPOINTS&quot;</span>,</div>
<div class="line">        CbState([SUCCEED], create_waypoints),</div>
<div class="line">        transitions={</div>
<div class="line">            SUCCEED: <span class="stringliteral">&quot;TAKING_RANDOM_WAYPOINTS&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;TAKING_RANDOM_WAYPOINTS&quot;</span>,</div>
<div class="line">        CbState([SUCCEED], take_random_waypoint),</div>
<div class="line">        transitions={</div>
<div class="line">            SUCCEED: <span class="stringliteral">&quot;NAVIGATING&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    nav_sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;GETTING_NEXT_WAYPOINT&quot;</span>,</div>
<div class="line">        CbState([END, HAS_NEXT], get_next_waypoint),</div>
<div class="line">        transitions={</div>
<div class="line">            END: SUCCEED,</div>
<div class="line">            HAS_NEXT: <span class="stringliteral">&quot;NAVIGATING&quot;</span>,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line">    nav_sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;NAVIGATING&quot;</span>,</div>
<div class="line">        Nav2State(),</div>
<div class="line">        transitions={</div>
<div class="line">            SUCCEED: <span class="stringliteral">&quot;GETTING_NEXT_WAYPOINT&quot;</span>,</div>
<div class="line">            CANCEL: CANCEL,</div>
<div class="line">            ABORT: ABORT,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    sm.add_state(</div>
<div class="line">        <span class="stringliteral">&quot;NAVIGATING&quot;</span>,</div>
<div class="line">        nav_sm,</div>
<div class="line">        transitions={</div>
<div class="line">            SUCCEED: SUCCEED,</div>
<div class="line">            CANCEL: CANCEL,</div>
<div class="line">            ABORT: ABORT,</div>
<div class="line">        },</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Publish FSM information for visualization</span></div>
<div class="line">    viewer = YasminViewerPub(sm, <span class="stringliteral">&quot;YASMIN_NAV2_DEMO&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Execute the state machine</span></div>
<div class="line">    blackboard = Blackboard()</div>
<div class="line">    blackboard[<span class="stringliteral">&quot;waypoints_num&quot;</span>] = 2  <span class="comment"># Set the number of waypoints to navigate</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Execute the FSM</span></div>
<div class="line">    <span class="keywordflow">try</span>:</div>
<div class="line">        outcome = sm(blackboard)</div>
<div class="line">        yasmin.YASMIN_LOG_INFO(outcome)</div>
<div class="line">    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">        yasmin.YASMIN_LOG_WARN(e)</div>
<div class="line">    <span class="keywordflow">finally</span>:</div>
<div class="line">        viewer.cleanup()</div>
<div class="line">        del sm</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># Shutdown ROS 2 if it&#39;s running</span></div>
<div class="line">    <span class="keywordflow">if</span> rclpy.ok():</div>
<div class="line">        rclpy.shutdown()</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
</div><!-- fragment --><p></p>
</details>
<h2><a class="anchor" id="autotoc_md19"></a>
Cpp</h2>
<h3><a class="anchor" id="autotoc_md20"></a>
Vanilla Demo</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos yasmin_demo</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;rclcpp/rclcpp.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="logs_8hpp.html">yasmin/logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="state_8hpp.html">yasmin/state.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="state__machine_8hpp.html">yasmin/state_machine.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ros__logs_8hpp.html">yasmin_ros/ros_logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="yasmin__viewer__pub_8hpp.html">yasmin_viewer/yasmin_viewer_pub.hpp</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classFooState.html">FooState</a> : <span class="keyword">public</span> <a class="code hl_class" href="classyasmin_1_1State.html">yasmin::State</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a>;</div>
<div class="line"></div>
<div class="line">  <a class="code hl_function" href="classFooState.html#a6ae85df2d67293997c452444c2e0b6a4">FooState</a>() : <a class="code hl_namespace" href="namespaceyasmin.html">yasmin</a>::State({<span class="stringliteral">&quot;outcome1&quot;</span>, <span class="stringliteral">&quot;outcome2&quot;</span>}), <a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a>(0){};</div>
<div class="line"></div>
<div class="line">  std::string</div>
<div class="line">  <a class="code hl_function" href="classFooState.html#ae23bada9c103a9618962d5de0c77bb6b">execute</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard)<span class="keyword"> override </span>{</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;Executing state FOO&quot;</span>);</div>
<div class="line">    std::this_thread::sleep_for(std::chrono::seconds(3));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a> &lt; 3) {</div>
<div class="line">      this-&gt;<a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a> += 1;</div>
<div class="line">      blackboard-&gt;set&lt;std::string&gt;(<span class="stringliteral">&quot;foo_str&quot;</span>,</div>
<div class="line">                                   <span class="stringliteral">&quot;Counter: &quot;</span> + std::to_string(this-&gt;<a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a>));</div>
<div class="line">      <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome1&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome2&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">  };</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classBarState.html">BarState</a> : <span class="keyword">public</span> <a class="code hl_class" href="classyasmin_1_1State.html">yasmin::State</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code hl_function" href="classBarState.html#afc590f0fcaaea12f89f14582ad60d866">BarState</a>() : yasmin::<a class="code hl_function" href="classyasmin_1_1State.html#a488b68da403b4b9ef55bef22885f1449">State</a>({<span class="stringliteral">&quot;outcome3&quot;</span>}) {}</div>
<div class="line"></div>
<div class="line">  std::string</div>
<div class="line">  <a class="code hl_function" href="classBarState.html#abb4afd02f9a2a473527dc3e139637685">execute</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard)<span class="keyword"> override </span>{</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;Executing state BAR&quot;</span>);</div>
<div class="line">    std::this_thread::sleep_for(std::chrono::seconds(3));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(blackboard-&gt;get&lt;std::string&gt;(<span class="stringliteral">&quot;foo_str&quot;</span>).c_str());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome3&quot;</span>;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">  <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;yasmin_demo&quot;</span>);</div>
<div class="line">  rclcpp::init(argc, argv);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set ROS 2 logs</span></div>
<div class="line">  <a class="code hl_function" href="namespaceyasmin__ros.html#aa2ab874c02c82fd169c8b3d066ddb106">yasmin_ros::set_ros_loggers</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create a state machine</span></div>
<div class="line">  <span class="keyword">auto</span> sm = std::make_shared&lt;yasmin::StateMachine&gt;(</div>
<div class="line">      std::initializer_list&lt;std::string&gt;{<span class="stringliteral">&quot;outcome4&quot;</span>}, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add states to the state machine</span></div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;FOO&quot;</span>, std::make_shared&lt;FooState&gt;(),</div>
<div class="line">                {</div>
<div class="line">                    {<span class="stringliteral">&quot;outcome1&quot;</span>, <span class="stringliteral">&quot;BAR&quot;</span>},</div>
<div class="line">                    {<span class="stringliteral">&quot;outcome2&quot;</span>, <span class="stringliteral">&quot;outcome4&quot;</span>},</div>
<div class="line">                });</div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;BAR&quot;</span>, std::make_shared&lt;BarState&gt;(),</div>
<div class="line">                {</div>
<div class="line">                    {<span class="stringliteral">&quot;outcome3&quot;</span>, <span class="stringliteral">&quot;FOO&quot;</span>},</div>
<div class="line">                });</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Publish state machine updates</span></div>
<div class="line">  <a class="code hl_class" href="classyasmin__viewer_1_1YasminViewerPub.html">yasmin_viewer::YasminViewerPub</a> yasmin_pub(sm, <span class="stringliteral">&quot;YASMIN_DEMO&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Execute the state machine</span></div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    std::string outcome = (*sm.get())();</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(outcome.c_str());</div>
<div class="line">  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#ae06a2a3a4eaa2d0fc4d4cc807e7d9d72">YASMIN_LOG_WARN</a>(e.what());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  rclcpp::shutdown();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassBarState_html_abb4afd02f9a2a473527dc3e139637685"><div class="ttname"><a href="classBarState.html#abb4afd02f9a2a473527dc3e139637685">BarState::execute</a></div><div class="ttdeci">std::string execute(std::shared_ptr&lt; yasmin::Blackboard &gt; blackboard) override</div><div class="ttdoc">Executes the Bar state logic.</div><div class="ttdef"><b>Definition</b> test_concurrence.cpp:46</div></div>
<div class="ttc" id="aclassBarState_html_afc590f0fcaaea12f89f14582ad60d866"><div class="ttname"><a href="classBarState.html#afc590f0fcaaea12f89f14582ad60d866">BarState::BarState</a></div><div class="ttdeci">BarState()</div><div class="ttdoc">Represents the &quot;Bar&quot; state in the state machine.</div><div class="ttdef"><b>Definition</b> test_concurrence.cpp:44</div></div>
<div class="ttc" id="aclassFooState_html_a6ae85df2d67293997c452444c2e0b6a4"><div class="ttname"><a href="classFooState.html#a6ae85df2d67293997c452444c2e0b6a4">FooState::FooState</a></div><div class="ttdeci">FooState()</div><div class="ttdoc">Represents the &quot;Foo&quot; state in the state machine.</div><div class="ttdef"><b>Definition</b> test_concurrence.cpp:31</div></div>
<div class="ttc" id="aclassFooState_html_a9c41a04e25dfd44c4e7fe32cb3cad467"><div class="ttname"><a href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">FooState::counter</a></div><div class="ttdeci">int counter</div><div class="ttdoc">Counter to track the number of executions.</div><div class="ttdef"><b>Definition</b> test_state_machine.cpp:28</div></div>
<div class="ttc" id="aclassFooState_html_ae23bada9c103a9618962d5de0c77bb6b"><div class="ttname"><a href="classFooState.html#ae23bada9c103a9618962d5de0c77bb6b">FooState::execute</a></div><div class="ttdeci">std::string execute(std::shared_ptr&lt; yasmin::Blackboard &gt; blackboard) override</div><div class="ttdoc">Executes the Foo state logic.</div><div class="ttdef"><b>Definition</b> test_concurrence.cpp:33</div></div>
<div class="ttc" id="aclassyasmin_1_1State_html"><div class="ttname"><a href="classyasmin_1_1State.html">yasmin::State</a></div><div class="ttdoc">Represents a state in a state machine.</div><div class="ttdef"><b>Definition</b> state.hpp:53</div></div>
<div class="ttc" id="aclassyasmin_1_1State_html_a488b68da403b4b9ef55bef22885f1449"><div class="ttname"><a href="classyasmin_1_1State.html#a488b68da403b4b9ef55bef22885f1449">yasmin::State::State</a></div><div class="ttdeci">State(const std::set&lt; std::string &gt; &amp;outcomes)</div><div class="ttdoc">Constructs a State with a set of possible outcomes.</div><div class="ttdef"><b>Definition</b> state.cpp:27</div></div>
<div class="ttc" id="aclassyasmin__viewer_1_1YasminViewerPub_html"><div class="ttname"><a href="classyasmin__viewer_1_1YasminViewerPub.html">yasmin_viewer::YasminViewerPub</a></div><div class="ttdoc">Publishes state machine data for visualization.</div><div class="ttdef"><b>Definition</b> yasmin_viewer_pub.hpp:39</div></div>
<div class="ttc" id="alogs_8hpp_html"><div class="ttname"><a href="logs_8hpp.html">logs.hpp</a></div></div>
<div class="ttc" id="alogs_8hpp_html_a054be408d85e8c53f3265107512555bd"><div class="ttname"><a href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a></div><div class="ttdeci">#define YASMIN_LOG_INFO(text,...)</div><div class="ttdef"><b>Definition</b> logs.hpp:169</div></div>
<div class="ttc" id="alogs_8hpp_html_ae06a2a3a4eaa2d0fc4d4cc807e7d9d72"><div class="ttname"><a href="logs_8hpp.html#ae06a2a3a4eaa2d0fc4d4cc807e7d9d72">YASMIN_LOG_WARN</a></div><div class="ttdeci">#define YASMIN_LOG_WARN(text,...)</div><div class="ttdef"><b>Definition</b> logs.hpp:164</div></div>
<div class="ttc" id="anamespaceyasmin__ros_html_aa2ab874c02c82fd169c8b3d066ddb106"><div class="ttname"><a href="namespaceyasmin__ros.html#aa2ab874c02c82fd169c8b3d066ddb106">yasmin_ros::set_ros_loggers</a></div><div class="ttdeci">void set_ros_loggers(rclcpp::Node::SharedPtr node=nullptr)</div><div class="ttdoc">Sets the logging functions for ROS, linking ROS 2 log levels to YASMIN loggers.</div><div class="ttdef"><b>Definition</b> ros_logs.cpp:62</div></div>
<div class="ttc" id="anamespaceyasmin_html"><div class="ttname"><a href="namespaceyasmin.html">yasmin</a></div><div class="ttdef"><b>Definition</b> blackboard.hpp:29</div></div>
<div class="ttc" id="aros__logs_8hpp_html"><div class="ttname"><a href="ros__logs_8hpp.html">ros_logs.hpp</a></div></div>
<div class="ttc" id="astate_8hpp_html"><div class="ttname"><a href="state_8hpp.html">state.hpp</a></div></div>
<div class="ttc" id="astate__machine_8hpp_html"><div class="ttname"><a href="state__machine_8hpp.html">state_machine.hpp</a></div></div>
<div class="ttc" id="ayasmin__viewer__pub_8hpp_html"><div class="ttname"><a href="yasmin__viewer__pub_8hpp.html">yasmin_viewer_pub.hpp</a></div></div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md21"></a>
Blackboard Remapping Demo</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos remap_demo</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;rclcpp/rclcpp.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="logs_8hpp.html">yasmin/logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="state_8hpp.html">yasmin/state.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="state__machine_8hpp.html">yasmin/state_machine.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="basic__outcomes_8hpp.html">yasmin_ros/basic_outcomes.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ros__logs_8hpp.html">yasmin_ros/ros_logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="yasmin__viewer__pub_8hpp.html">yasmin_viewer/yasmin_viewer_pub.hpp</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classFooState.html">FooState</a> : <span class="keyword">public</span> <a class="code hl_class" href="classyasmin_1_1State.html">yasmin::State</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code hl_function" href="classFooState.html#a6ae85df2d67293997c452444c2e0b6a4">FooState</a>() : <a class="code hl_namespace" href="namespaceyasmin.html">yasmin</a>::State({<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>}){};</div>
<div class="line"></div>
<div class="line">  std::string</div>
<div class="line">  <a class="code hl_function" href="classFooState.html#ae23bada9c103a9618962d5de0c77bb6b">execute</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard)<span class="keyword"> override </span>{</div>
<div class="line">    std::string data = blackboard-&gt;get&lt;std::string&gt;(<span class="stringliteral">&quot;foo_data&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;%s&quot;</span>, data.c_str());</div>
<div class="line">    blackboard-&gt;set&lt;std::string&gt;(<span class="stringliteral">&quot;foo_out_data&quot;</span>, data);</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>;</div>
<div class="line">  };</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classBarState.html">BarState</a> : <span class="keyword">public</span> <a class="code hl_class" href="classyasmin_1_1State.html">yasmin::State</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code hl_function" href="classBarState.html#afc590f0fcaaea12f89f14582ad60d866">BarState</a>() : yasmin::<a class="code hl_function" href="classyasmin_1_1State.html#a488b68da403b4b9ef55bef22885f1449">State</a>({<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>}) {}</div>
<div class="line"></div>
<div class="line">  std::string</div>
<div class="line">  <a class="code hl_function" href="classBarState.html#abb4afd02f9a2a473527dc3e139637685">execute</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard)<span class="keyword"> override </span>{</div>
<div class="line">    std::string datga = blackboard-&gt;get&lt;std::string&gt;(<span class="stringliteral">&quot;bar_data&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;%s&quot;</span>, datga.c_str());</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">  <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;yasmin_remapping_demo&quot;</span>);</div>
<div class="line">  rclcpp::init(argc, argv);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set ROS 2 logs</span></div>
<div class="line">  <a class="code hl_function" href="namespaceyasmin__ros.html#aa2ab874c02c82fd169c8b3d066ddb106">yasmin_ros::set_ros_loggers</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create blackboard</span></div>
<div class="line">  <span class="keyword">auto</span> blackboard = std::make_shared&lt;yasmin::Blackboard&gt;();</div>
<div class="line">  blackboard-&gt;set&lt;std::string&gt;(<span class="stringliteral">&quot;msg1&quot;</span>, <span class="stringliteral">&quot;test1&quot;</span>);</div>
<div class="line">  blackboard-&gt;set&lt;std::string&gt;(<span class="stringliteral">&quot;msg2&quot;</span>, <span class="stringliteral">&quot;test2&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create a state machine</span></div>
<div class="line">  <span class="keyword">auto</span> sm = std::make_shared&lt;yasmin::StateMachine&gt;(</div>
<div class="line">      std::initializer_list&lt;std::string&gt;{<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>},</div>
<div class="line">      <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add states to the state machine</span></div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;STATE1&quot;</span>, std::make_shared&lt;FooState&gt;(),</div>
<div class="line">                {</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>, <span class="stringliteral">&quot;STATE2&quot;</span>},</div>
<div class="line">                },</div>
<div class="line">                {</div>
<div class="line">                    {<span class="stringliteral">&quot;foo_data&quot;</span>, <span class="stringliteral">&quot;msg1&quot;</span>},</div>
<div class="line">                });</div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;STATE2&quot;</span>, std::make_shared&lt;FooState&gt;(),</div>
<div class="line">                {</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>, <span class="stringliteral">&quot;STATE3&quot;</span>},</div>
<div class="line">                },</div>
<div class="line">                {</div>
<div class="line">                    {<span class="stringliteral">&quot;foo_data&quot;</span>, <span class="stringliteral">&quot;msg2&quot;</span>},</div>
<div class="line">                });</div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;STATE3&quot;</span>, std::make_shared&lt;BarState&gt;(),</div>
<div class="line">                {</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>,</div>
<div class="line">                     <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>},</div>
<div class="line">                },</div>
<div class="line">                {</div>
<div class="line">                    {<span class="stringliteral">&quot;bar_data&quot;</span>, <span class="stringliteral">&quot;foo_out_data&quot;</span>},</div>
<div class="line">                });</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Publish state machine updates</span></div>
<div class="line">  <a class="code hl_class" href="classyasmin__viewer_1_1YasminViewerPub.html">yasmin_viewer::YasminViewerPub</a> yasmin_pub(sm, <span class="stringliteral">&quot;YASMIN_REMAPPING_DEMO&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Execute the state machine</span></div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    std::string outcome = (*sm.get())(blackboard);</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(outcome.c_str());</div>
<div class="line">  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#ae06a2a3a4eaa2d0fc4d4cc807e7d9d72">YASMIN_LOG_WARN</a>(e.what());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  rclcpp::shutdown();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="abasic__outcomes_8hpp_html"><div class="ttname"><a href="basic__outcomes_8hpp.html">basic_outcomes.hpp</a></div></div>
<div class="ttc" id="anamespaceyasmin__ros_1_1basic__outcomes_html_a5573f527607429f73c199d683f78a6a7"><div class="ttname"><a href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a></div><div class="ttdeci">constexpr char SUCCEED[]</div><div class="ttdoc">Constant representing a successful action outcome.</div><div class="ttdef"><b>Definition</b> basic_outcomes.hpp:39</div></div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md22"></a>
Concurrence Demo</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos concurrence_demo</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;rclcpp/rclcpp.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="concurrence_8hpp.html">yasmin/concurrence.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="logs_8hpp.html">yasmin/logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="state_8hpp.html">yasmin/state.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="state__machine_8hpp.html">yasmin/state_machine.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ros__logs_8hpp.html">yasmin_ros/ros_logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="yasmin__viewer__pub_8hpp.html">yasmin_viewer/yasmin_viewer_pub.hpp</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classFooState.html">FooState</a> : <span class="keyword">public</span> <a class="code hl_class" href="classyasmin_1_1State.html">yasmin::State</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a>;</div>
<div class="line"></div>
<div class="line">  <a class="code hl_function" href="classFooState.html#a6ae85df2d67293997c452444c2e0b6a4">FooState</a>()</div>
<div class="line">      : <a class="code hl_namespace" href="namespaceyasmin.html">yasmin</a>::State({<span class="stringliteral">&quot;outcome1&quot;</span>, <span class="stringliteral">&quot;outcome2&quot;</span>, <span class="stringliteral">&quot;outcome3&quot;</span>}), <a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a>(0){};</div>
<div class="line"></div>
<div class="line">  std::string</div>
<div class="line">  <a class="code hl_function" href="classFooState.html#ae23bada9c103a9618962d5de0c77bb6b">execute</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard)<span class="keyword"> override </span>{</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;Executing state FOO&quot;</span>);</div>
<div class="line">    std::this_thread::sleep_for(std::chrono::seconds(2));</div>
<div class="line"> </div>
<div class="line">    std::string outcome;</div>
<div class="line"> </div>
<div class="line">    blackboard-&gt;set&lt;std::string&gt;(<span class="stringliteral">&quot;foo_str&quot;</span>,</div>
<div class="line">                                 <span class="stringliteral">&quot;Counter: &quot;</span> + std::to_string(this-&gt;<a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a> &lt; 3) {</div>
<div class="line">      outcome = <span class="stringliteral">&quot;outcome1&quot;</span>;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a> &lt; 5) {</div>
<div class="line">      outcome = <span class="stringliteral">&quot;outcome2&quot;</span>;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      outcome = <span class="stringliteral">&quot;outcome3&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;Finishing state FOO&quot;</span>);</div>
<div class="line">    this-&gt;<a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a> += 1;</div>
<div class="line">    <span class="keywordflow">return</span> outcome;</div>
<div class="line">  };</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classBarState.html">BarState</a> : <span class="keyword">public</span> <a class="code hl_class" href="classyasmin_1_1State.html">yasmin::State</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code hl_function" href="classBarState.html#afc590f0fcaaea12f89f14582ad60d866">BarState</a>() : yasmin::<a class="code hl_function" href="classyasmin_1_1State.html#a488b68da403b4b9ef55bef22885f1449">State</a>({<span class="stringliteral">&quot;outcome3&quot;</span>}) {}</div>
<div class="line"></div>
<div class="line">  std::string</div>
<div class="line">  <a class="code hl_function" href="classBarState.html#abb4afd02f9a2a473527dc3e139637685">execute</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard)<span class="keyword"> override </span>{</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;Executing state BAR&quot;</span>);</div>
<div class="line">    std::this_thread::sleep_for(std::chrono::seconds(4));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (blackboard-&gt;contains(<span class="stringliteral">&quot;foo_str&quot;</span>)) {</div>
<div class="line">      <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(blackboard-&gt;get&lt;std::string&gt;(<span class="stringliteral">&quot;foo_str&quot;</span>).c_str());</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;blackboard does not yet contains &#39;foo_str&#39;&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;Finishing state BAR&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome3&quot;</span>;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">  <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;yasmin_concurrence_demo&quot;</span>);</div>
<div class="line">  rclcpp::init(argc, argv);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set ROS 2 logs</span></div>
<div class="line">  <a class="code hl_function" href="namespaceyasmin__ros.html#aa2ab874c02c82fd169c8b3d066ddb106">yasmin_ros::set_ros_loggers</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create a state machine</span></div>
<div class="line">  <span class="keyword">auto</span> sm = std::make_shared&lt;yasmin::StateMachine&gt;(</div>
<div class="line">      std::initializer_list&lt;std::string&gt;{<span class="stringliteral">&quot;outcome4&quot;</span>}, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create states to run concurrently</span></div>
<div class="line">  <span class="keyword">auto</span> foo_state = std::make_shared&lt;FooState&gt;();</div>
<div class="line">  <span class="keyword">auto</span> bar_state = std::make_shared&lt;BarState&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create concurrent state</span></div>
<div class="line">  <span class="keyword">auto</span> concurrent_state = std::make_shared&lt;yasmin::Concurrence&gt;(</div>
<div class="line">      std::map&lt;std::string, std::shared_ptr&lt;yasmin::State&gt;&gt;{{<span class="stringliteral">&quot;FOO&quot;</span>, foo_state},</div>
<div class="line">                                                            {<span class="stringliteral">&quot;BAR&quot;</span>, bar_state}},</div>
<div class="line">      <span class="stringliteral">&quot;defaulted&quot;</span>,</div>
<div class="line">      <a class="code hl_typedef" href="classyasmin_1_1Concurrence.html#a67ec1d425875a9d5724dc391441df25b">yasmin::Concurrence::OutcomeMap</a>{</div>
<div class="line">          {<span class="stringliteral">&quot;outcome1&quot;</span>,</div>
<div class="line">           <a class="code hl_typedef" href="classyasmin_1_1Concurrence.html#a85123e277b915c6c290b4eb97999d380">yasmin::Concurrence::StateOutcomeMap</a>{{<span class="stringliteral">&quot;FOO&quot;</span>, <span class="stringliteral">&quot;outcome1&quot;</span>},</div>
<div class="line">                                                {<span class="stringliteral">&quot;BAR&quot;</span>, <span class="stringliteral">&quot;outcome3&quot;</span>}}},</div>
<div class="line">          {<span class="stringliteral">&quot;outcome2&quot;</span>, <a class="code hl_typedef" href="classyasmin_1_1Concurrence.html#a85123e277b915c6c290b4eb97999d380">yasmin::Concurrence::StateOutcomeMap</a>{</div>
<div class="line">                           {<span class="stringliteral">&quot;FOO&quot;</span>, <span class="stringliteral">&quot;outcome2&quot;</span>}, {<span class="stringliteral">&quot;BAR&quot;</span>, <span class="stringliteral">&quot;outcome3&quot;</span>}}}});</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add concurrent state to the state machine</span></div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;CONCURRENCE&quot;</span>, concurrent_state,</div>
<div class="line">                {</div>
<div class="line">                    {<span class="stringliteral">&quot;outcome1&quot;</span>, <span class="stringliteral">&quot;CONCURRENCE&quot;</span>},</div>
<div class="line">                    {<span class="stringliteral">&quot;outcome2&quot;</span>, <span class="stringliteral">&quot;CONCURRENCE&quot;</span>},</div>
<div class="line">                    {<span class="stringliteral">&quot;defaulted&quot;</span>, <span class="stringliteral">&quot;outcome4&quot;</span>},</div>
<div class="line">                });</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Publish state machine updates</span></div>
<div class="line">  <a class="code hl_class" href="classyasmin__viewer_1_1YasminViewerPub.html">yasmin_viewer::YasminViewerPub</a> yasmin_pub(sm, <span class="stringliteral">&quot;YASMIN_CONCURRENCE_DEMO&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Execute the state machine</span></div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    std::string outcome = (*sm.get())();</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(outcome.c_str());</div>
<div class="line">  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#ae06a2a3a4eaa2d0fc4d4cc807e7d9d72">YASMIN_LOG_WARN</a>(e.what());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  rclcpp::shutdown();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassyasmin_1_1Concurrence_html_a67ec1d425875a9d5724dc391441df25b"><div class="ttname"><a href="classyasmin_1_1Concurrence.html#a67ec1d425875a9d5724dc391441df25b">yasmin::Concurrence::OutcomeMap</a></div><div class="ttdeci">std::map&lt; std::string, StateOutcomeMap &gt; OutcomeMap</div><div class="ttdef"><b>Definition</b> concurrence.hpp:52</div></div>
<div class="ttc" id="aclassyasmin_1_1Concurrence_html_a85123e277b915c6c290b4eb97999d380"><div class="ttname"><a href="classyasmin_1_1Concurrence.html#a85123e277b915c6c290b4eb97999d380">yasmin::Concurrence::StateOutcomeMap</a></div><div class="ttdeci">std::map&lt; std::string, std::string &gt; StateOutcomeMap</div><div class="ttdef"><b>Definition</b> concurrence.hpp:51</div></div>
<div class="ttc" id="aconcurrence_8hpp_html"><div class="ttname"><a href="concurrence_8hpp.html">concurrence.hpp</a></div></div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md23"></a>
Publisher Demo (FSM + ROS 2 Publisher)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos publisher_demo</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;rclcpp/rclcpp.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;std_msgs/msg/int32.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="cb__state_8hpp.html">yasmin/cb_state.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="logs_8hpp.html">yasmin/logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="state__machine_8hpp.html">yasmin/state_machine.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="basic__outcomes_8hpp.html">yasmin_ros/basic_outcomes.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="publisher__state_8hpp.html">yasmin_ros/publisher_state.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ros__logs_8hpp.html">yasmin_ros/ros_logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="yasmin__viewer__pub_8hpp.html">yasmin_viewer/yasmin_viewer_pub.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>std::placeholders::_1;</div>
<div class="line"><span class="keyword">using </span>std::placeholders::_2;</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classPublishIntState.html">PublishIntState</a></div>
<div class="line">    : <span class="keyword">public</span> <a class="code hl_class" href="classyasmin__ros_1_1PublisherState.html">yasmin_ros::PublisherState</a>&lt;std_msgs::msg::Int32&gt; {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code hl_function" href="classPublishIntState.html#a6f27fddf9b2f2e70cb86a9ff64517625">PublishIntState</a>()</div>
<div class="line">      : <a class="code hl_namespace" href="namespaceyasmin__ros.html">yasmin_ros</a>::<a class="code hl_function" href="classyasmin__ros_1_1PublisherState.html#a5e50083f85017666c10b227622dfefdc">PublisherState</a>&lt;std_msgs::msg::Int32&gt;(</div>
<div class="line">            <span class="stringliteral">&quot;count&quot;</span>, <span class="comment">// topic name</span></div>
<div class="line">            std::bind(&amp;<a class="code hl_class" href="classPublishIntState.html">PublishIntState</a>::<a class="code hl_function" href="classPublishIntState.html#a57ac2c499996c72790ad734c99243e94">create_int_msg</a>, this,</div>
<div class="line">                      _1) <span class="comment">// create msg handler callback</span></div>
<div class="line">        ){};</div>
<div class="line"></div>
<div class="line">  std_msgs::msg::Int32</div>
<div class="line">  <a class="code hl_function" href="classPublishIntState.html#a57ac2c499996c72790ad734c99243e94">create_int_msg</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard) {</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> counter = blackboard-&gt;get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;counter&quot;</span>);</div>
<div class="line">    counter++;</div>
<div class="line">    blackboard-&gt;set&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;counter&quot;</span>, counter);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;Creating message %d&quot;</span>, counter);</div>
<div class="line">    std_msgs::msg::Int32 msg;</div>
<div class="line">    msg.data = counter;</div>
<div class="line">    <span class="keywordflow">return</span> msg;</div>
<div class="line">  };</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line">std::string</div>
<div class="line"><a class="code hl_function" href="publisher__demo_8cpp.html#a6fb402ab26a1b2ee540d9ec2f6138300">check_count</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard) {</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Sleep for 1 second to simulate some processing time</span></div>
<div class="line">  rclcpp::sleep_for(std::chrono::seconds(1));</div>
<div class="line">  <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;Checking count: %d&quot;</span>, blackboard-&gt;get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;counter&quot;</span>));</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (blackboard-&gt;get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;counter&quot;</span>) &gt;= blackboard-&gt;get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;max_count&quot;</span>)) {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome1&quot;</span>;</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome2&quot;</span>;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;yasmin_publisher_demo&quot;</span>);</div>
<div class="line">  rclcpp::init(argc, argv);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set up ROS 2 loggers</span></div>
<div class="line">  <a class="code hl_function" href="namespaceyasmin__ros.html#aa2ab874c02c82fd169c8b3d066ddb106">yasmin_ros::set_ros_loggers</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create a state machine with a final outcome</span></div>
<div class="line">  <span class="keyword">auto</span> sm = std::make_shared&lt;yasmin::StateMachine&gt;(</div>
<div class="line">      std::initializer_list&lt;std::string&gt;{<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>},</div>
<div class="line">      <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add states to the state machine</span></div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;PUBLISHING_INT&quot;</span>, std::make_shared&lt;PublishIntState&gt;(),</div>
<div class="line">                {</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>,</div>
<div class="line">                     <span class="stringliteral">&quot;CHECKINNG_COUNTS&quot;</span>}, <span class="comment">// Transition back to itself</span></div>
<div class="line">                });</div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;CHECKINNG_COUNTS&quot;</span>,</div>
<div class="line">                std::make_shared&lt;yasmin::CbState&gt;(</div>
<div class="line">                    std::initializer_list&lt;std::string&gt;{<span class="stringliteral">&quot;outcome1&quot;</span>, <span class="stringliteral">&quot;outcome2&quot;</span>},</div>
<div class="line">                    <a class="code hl_function" href="publisher__demo_8cpp.html#a6fb402ab26a1b2ee540d9ec2f6138300">check_count</a>),</div>
<div class="line">                {{<span class="stringliteral">&quot;outcome1&quot;</span>, <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>},</div>
<div class="line">                 {<span class="stringliteral">&quot;outcome2&quot;</span>, <span class="stringliteral">&quot;PUBLISHING_INT&quot;</span>}});</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Publisher for visualizing the state machine&#39;s status</span></div>
<div class="line">  <a class="code hl_class" href="classyasmin__viewer_1_1YasminViewerPub.html">yasmin_viewer::YasminViewerPub</a> yasmin_pub(sm, <span class="stringliteral">&quot;YASMIN_PUBLISHER_DEMO&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Execute the state machine</span></div>
<div class="line">  std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard =</div>
<div class="line">      std::make_shared&lt;yasmin::Blackboard&gt;();</div>
<div class="line">  blackboard-&gt;set&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;counter&quot;</span>, 0);</div>
<div class="line">  blackboard-&gt;set&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;max_count&quot;</span>, 10);</div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    std::string outcome = (*sm.get())(blackboard);</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(outcome.c_str());</div>
<div class="line">  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#ae06a2a3a4eaa2d0fc4d4cc807e7d9d72">YASMIN_LOG_WARN</a>(e.what());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  rclcpp::shutdown();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="acb__state_8hpp_html"><div class="ttname"><a href="cb__state_8hpp.html">cb_state.hpp</a></div></div>
<div class="ttc" id="aclassPublishIntState_html_a57ac2c499996c72790ad734c99243e94"><div class="ttname"><a href="classPublishIntState.html#a57ac2c499996c72790ad734c99243e94">PublishIntState::create_int_msg</a></div><div class="ttdeci">std_msgs::msg::Int32 create_int_msg(std::shared_ptr&lt; yasmin::Blackboard &gt; blackboard)</div><div class="ttdoc">Create a new Int message.</div><div class="ttdef"><b>Definition</b> publisher_demo.cpp:64</div></div>
<div class="ttc" id="aclassPublishIntState_html_a6f27fddf9b2f2e70cb86a9ff64517625"><div class="ttname"><a href="classPublishIntState.html#a6f27fddf9b2f2e70cb86a9ff64517625">PublishIntState::PublishIntState</a></div><div class="ttdeci">PublishIntState()</div><div class="ttdoc">Constructor for the PublishIntState class.</div><div class="ttdef"><b>Definition</b> publisher_demo.cpp:48</div></div>
<div class="ttc" id="aclassyasmin__ros_1_1PublisherState_html"><div class="ttname"><a href="classyasmin__ros_1_1PublisherState.html">yasmin_ros::PublisherState</a></div><div class="ttdoc">Template class to publish ROS 2 messages.</div><div class="ttdef"><b>Definition</b> publisher_state.hpp:42</div></div>
<div class="ttc" id="anamespaceyasmin__ros_html"><div class="ttname"><a href="namespaceyasmin__ros.html">yasmin_ros</a></div><div class="ttdef"><b>Definition</b> action_state.hpp:37</div></div>
<div class="ttc" id="apublisher__state_8hpp_html"><div class="ttname"><a href="publisher__state_8hpp.html">publisher_state.hpp</a></div></div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md24"></a>
Monitor Demo (FSM + ROS 2 Subscriber)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos monitor_demo</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;nav_msgs/msg/odometry.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;rclcpp/rclcpp.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="logs_8hpp.html">yasmin/logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="state__machine_8hpp.html">yasmin/state_machine.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="basic__outcomes_8hpp.html">yasmin_ros/basic_outcomes.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="monitor__state_8hpp.html">yasmin_ros/monitor_state.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ros__logs_8hpp.html">yasmin_ros/ros_logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="yasmin__viewer__pub_8hpp.html">yasmin_viewer/yasmin_viewer_pub.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>std::placeholders::_1;</div>
<div class="line"><span class="keyword">using </span>std::placeholders::_2;</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classPrintOdometryState.html">PrintOdometryState</a></div>
<div class="line">    : <span class="keyword">public</span> <a class="code hl_class" href="classyasmin__ros_1_1MonitorState.html">yasmin_ros::MonitorState</a>&lt;nav_msgs::msg::Odometry&gt; {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="classPrintOdometryState.html#ac26fa7c2dc61ebd7ee0a12026fa7c1ec">times</a>;</div>
<div class="line"></div>
<div class="line">  <a class="code hl_function" href="classPrintOdometryState.html#a7077bc7b49ec1036a47409a37fae84e2">PrintOdometryState</a>(<span class="keywordtype">int</span> <a class="code hl_variable" href="classPrintOdometryState.html#ac26fa7c2dc61ebd7ee0a12026fa7c1ec">times</a>)</div>
<div class="line">      : <a class="code hl_namespace" href="namespaceyasmin__ros.html">yasmin_ros</a>::<a class="code hl_function" href="classyasmin__ros_1_1MonitorState.html#ac37eb81dc449d9f7f53948c0211676a0">MonitorState</a>&lt;nav_msgs::msg::Odometry&gt;(</div>
<div class="line">            <span class="stringliteral">&quot;odom&quot;</span>,                   <span class="comment">// topic name</span></div>
<div class="line">            {<span class="stringliteral">&quot;outcome1&quot;</span>, <span class="stringliteral">&quot;outcome2&quot;</span>}, <span class="comment">// possible outcomes</span></div>
<div class="line">            std::bind(&amp;<a class="code hl_function" href="classPrintOdometryState.html#a3a4028aea879c1638c4b92853e763070">PrintOdometryState::monitor_handler</a>, <span class="keyword">this</span>, _1,</div>
<div class="line">                      _2), <span class="comment">// monitor handler callback</span></div>
<div class="line">            10,            <span class="comment">// QoS for the topic subscription</span></div>
<div class="line">            10,            <span class="comment">// queue size for the callback</span></div>
<div class="line">            10             <span class="comment">// timeout for receiving messages</span></div>
<div class="line">        ) {</div>
<div class="line">    this-&gt;times = <a class="code hl_variable" href="classPrintOdometryState.html#ac26fa7c2dc61ebd7ee0a12026fa7c1ec">times</a>;</div>
<div class="line">  };</div>
<div class="line"></div>
<div class="line">  std::string</div>
<div class="line">  <a class="code hl_variable" href="classyasmin__ros_1_1MonitorState.html#a49277a171d35159f716f5605b185df4b">monitor_handler</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard,</div>
<div class="line">                  std::shared_ptr&lt;nav_msgs::msg::Odometry&gt; msg) {</div>
<div class="line"> </div>
<div class="line">    (void)blackboard; <span class="comment">// blackboard is not used in this implementation</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;x: %f&quot;</span>, msg-&gt;pose.pose.position.x);</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;y: %f&quot;</span>, msg-&gt;pose.pose.position.y);</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;z: %f&quot;</span>, msg-&gt;pose.pose.position.z);</div>
<div class="line"> </div>
<div class="line">    this-&gt;<a class="code hl_variable" href="classPrintOdometryState.html#ac26fa7c2dc61ebd7ee0a12026fa7c1ec">times</a>--;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Transition based on remaining times</span></div>
<div class="line">    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classPrintOdometryState.html#ac26fa7c2dc61ebd7ee0a12026fa7c1ec">times</a> &lt;= 0) {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome2&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome1&quot;</span>;</div>
<div class="line">  };</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;yasmin_monitor_demo&quot;</span>);</div>
<div class="line">  rclcpp::init(argc, argv);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set up ROS 2 loggers</span></div>
<div class="line">  <a class="code hl_function" href="namespaceyasmin__ros.html#aa2ab874c02c82fd169c8b3d066ddb106">yasmin_ros::set_ros_loggers</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create a state machine with a final outcome</span></div>
<div class="line">  <span class="keyword">auto</span> sm = std::make_shared&lt;yasmin::StateMachine&gt;(</div>
<div class="line">      std::initializer_list&lt;std::string&gt;{<span class="stringliteral">&quot;outcome4&quot;</span>}, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add states to the state machine</span></div>
<div class="line">  sm-&gt;add_state(</div>
<div class="line">      <span class="stringliteral">&quot;PRINTING_ODOM&quot;</span>, std::make_shared&lt;PrintOdometryState&gt;(5),</div>
<div class="line">      {</div>
<div class="line">          {<span class="stringliteral">&quot;outcome1&quot;</span>,</div>
<div class="line">           <span class="stringliteral">&quot;PRINTING_ODOM&quot;</span>},        <span class="comment">// Transition back to itself on outcome1</span></div>
<div class="line">          {<span class="stringliteral">&quot;outcome2&quot;</span>, <span class="stringliteral">&quot;outcome4&quot;</span>}, <span class="comment">// Transition to outcome4 on outcome2</span></div>
<div class="line">          {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#aa1e861086a64adb5672adec78f7c3316">yasmin_ros::basic_outcomes::TIMEOUT</a>,</div>
<div class="line">           <span class="stringliteral">&quot;outcome4&quot;</span>}, <span class="comment">// Timeout transition</span></div>
<div class="line">      });</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Publisher for visualizing the state machine&#39;s status</span></div>
<div class="line">  <a class="code hl_class" href="classyasmin__viewer_1_1YasminViewerPub.html">yasmin_viewer::YasminViewerPub</a> yasmin_pub(sm, <span class="stringliteral">&quot;YASMIN_MONITOR_DEMO&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Execute the state machine</span></div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    std::string outcome = (*sm.get())();</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(outcome.c_str());</div>
<div class="line">  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#ae06a2a3a4eaa2d0fc4d4cc807e7d9d72">YASMIN_LOG_WARN</a>(e.what());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  rclcpp::shutdown();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassPrintOdometryState_html_a3a4028aea879c1638c4b92853e763070"><div class="ttname"><a href="classPrintOdometryState.html#a3a4028aea879c1638c4b92853e763070">PrintOdometryState::monitor_handler</a></div><div class="ttdeci">std::string monitor_handler(std::shared_ptr&lt; yasmin::Blackboard &gt; blackboard, std::shared_ptr&lt; nav_msgs::msg::Odometry &gt; msg)</div><div class="ttdoc">Handler for processing odometry data.</div><div class="ttdef"><b>Definition</b> monitor_demo.cpp:80</div></div>
<div class="ttc" id="aclassPrintOdometryState_html_a7077bc7b49ec1036a47409a37fae84e2"><div class="ttname"><a href="classPrintOdometryState.html#a7077bc7b49ec1036a47409a37fae84e2">PrintOdometryState::PrintOdometryState</a></div><div class="ttdeci">PrintOdometryState(int times)</div><div class="ttdoc">Constructor for the PrintOdometryState class.</div><div class="ttdef"><b>Definition</b> monitor_demo.cpp:53</div></div>
<div class="ttc" id="aclassPrintOdometryState_html_ac26fa7c2dc61ebd7ee0a12026fa7c1ec"><div class="ttname"><a href="classPrintOdometryState.html#ac26fa7c2dc61ebd7ee0a12026fa7c1ec">PrintOdometryState::times</a></div><div class="ttdeci">int times</div><div class="ttdoc">The number of times the state will process messages.</div><div class="ttdef"><b>Definition</b> monitor_demo.cpp:47</div></div>
<div class="ttc" id="aclassyasmin__ros_1_1MonitorState_html"><div class="ttname"><a href="classyasmin__ros_1_1MonitorState.html">yasmin_ros::MonitorState</a></div><div class="ttdoc">Template class to monitor a ROS 2 topic and process incoming messages.</div><div class="ttdef"><b>Definition</b> monitor_state.hpp:48</div></div>
<div class="ttc" id="aclassyasmin__ros_1_1MonitorState_html_a49277a171d35159f716f5605b185df4b"><div class="ttname"><a href="classyasmin__ros_1_1MonitorState.html#a49277a171d35159f716f5605b185df4b">yasmin_ros::MonitorState&lt; nav_msgs::msg::Odometry &gt;::monitor_handler</a></div><div class="ttdeci">MonitorHandler monitor_handler</div><div class="ttdef"><b>Definition</b> monitor_state.hpp:227</div></div>
<div class="ttc" id="amonitor__state_8hpp_html"><div class="ttname"><a href="monitor__state_8hpp.html">monitor_state.hpp</a></div></div>
<div class="ttc" id="anamespaceyasmin__ros_1_1basic__outcomes_html_aa1e861086a64adb5672adec78f7c3316"><div class="ttname"><a href="namespaceyasmin__ros_1_1basic__outcomes.html#aa1e861086a64adb5672adec78f7c3316">yasmin_ros::basic_outcomes::TIMEOUT</a></div><div class="ttdeci">constexpr char TIMEOUT[]</div><div class="ttdoc">Constant representing a timed-out action outcome.</div><div class="ttdef"><b>Definition</b> basic_outcomes.hpp:71</div></div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md25"></a>
Service Demo (FSM + ROS 2 Service Client)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos add_two_ints_server</div>
</div><!-- fragment --><div class="fragment"><div class="line">ros2 run yasmin_demos service_client_demo</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;example_interfaces/srv/add_two_ints.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;rclcpp/rclcpp.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="cb__state_8hpp.html">yasmin/cb_state.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="logs_8hpp.html">yasmin/logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="state__machine_8hpp.html">yasmin/state_machine.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="basic__outcomes_8hpp.html">yasmin_ros/basic_outcomes.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ros__logs_8hpp.html">yasmin_ros/ros_logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="service__state_8hpp.html">yasmin_ros/service_state.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="yasmin__viewer__pub_8hpp.html">yasmin_viewer/yasmin_viewer_pub.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>std::placeholders::_1;</div>
<div class="line"><span class="keyword">using </span>std::placeholders::_2;</div>
<div class="line"></div>
<div class="line">std::string</div>
<div class="line"><a class="code hl_function" href="service__client__demo_8cpp.html#a73d2bd5c99568a599143915a2483201d">set_ints</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard) {</div>
<div class="line">  blackboard-&gt;set&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;a&quot;</span>, 10);</div>
<div class="line">  blackboard-&gt;set&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;b&quot;</span>, 5);</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">std::string</div>
<div class="line"><a class="code hl_function" href="service__client__demo_8cpp.html#accc90ce177b13fe70630560b1662ecac">print_sum</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard) {</div>
<div class="line">  std::stringstream ss;</div>
<div class="line">  ss &lt;&lt; <span class="stringliteral">&quot;Sum: &quot;</span> &lt;&lt; blackboard-&gt;get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;sum&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(ss.str().c_str());</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classAddTwoIntsState.html">AddTwoIntsState</a></div>
<div class="line">    : <span class="keyword">public</span> <a class="code hl_class" href="classyasmin__ros_1_1ServiceState.html">yasmin_ros::ServiceState</a>&lt;example_interfaces::srv::AddTwoInts&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code hl_function" href="classAddTwoIntsState.html#adafe175a2a8667af73abeee9cd0439f0">AddTwoIntsState</a>()</div>
<div class="line">      : yasmin_ros::<a class="code hl_function" href="classyasmin__ros_1_1ServiceState.html#ad0f500a0f2fc16461cf19c1213d761a2">ServiceState</a>&lt;example_interfaces::srv::AddTwoInts&gt;(</div>
<div class="line">            <span class="stringliteral">&quot;/add_two_ints&quot;</span>,</div>
<div class="line">            std::bind(&amp;<a class="code hl_function" href="classAddTwoIntsState.html#adafe175a2a8667af73abeee9cd0439f0">AddTwoIntsState</a>::<a class="code hl_function" href="classAddTwoIntsState.html#a1c88b3b5280dd3eeccfe4eabaaba3f3f">create_request_handler</a>, this, _1),</div>
<div class="line">            {<span class="stringliteral">&quot;outcome1&quot;</span>},</div>
<div class="line">            std::bind(&amp;<a class="code hl_variable" href="classyasmin__ros_1_1ServiceState.html#a250abf3c365cd36e63170b35db29b62c">AddTwoIntsState::response_handler</a>, <span class="keyword">this</span>, _1, _2)){};</div>
<div class="line"></div>
<div class="line">  example_interfaces::srv::AddTwoInts::Request::SharedPtr</div>
<div class="line">  <a class="code hl_variable" href="classyasmin__ros_1_1ServiceState.html#a089345db165d860c0b84a755b6cf49e0">create_request_handler</a>(</div>
<div class="line">      std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> request =</div>
<div class="line">        std::make_shared&lt;example_interfaces::srv::AddTwoInts::Request&gt;();</div>
<div class="line">    request-&gt;a = blackboard-&gt;get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line">    request-&gt;b = blackboard-&gt;get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;b&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> request;</div>
<div class="line">  };</div>
<div class="line"></div>
<div class="line">  std::string <a class="code hl_variable" href="classyasmin__ros_1_1ServiceState.html#a250abf3c365cd36e63170b35db29b62c">response_handler</a>(</div>
<div class="line">      std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard,</div>
<div class="line">      example_interfaces::srv::AddTwoInts::Response::SharedPtr response) {</div>
<div class="line"> </div>
<div class="line">    blackboard-&gt;set&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;sum&quot;</span>, response-&gt;sum);</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome1&quot;</span>;</div>
<div class="line">  };</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">  <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;yasmin_service_client_demo&quot;</span>);</div>
<div class="line">  rclcpp::init(argc, argv);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set up ROS 2 logging.</span></div>
<div class="line">  <a class="code hl_function" href="namespaceyasmin__ros.html#aa2ab874c02c82fd169c8b3d066ddb106">yasmin_ros::set_ros_loggers</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create a state machine with a specified outcome.</span></div>
<div class="line">  <span class="keyword">auto</span> sm = std::make_shared&lt;yasmin::StateMachine&gt;(</div>
<div class="line">      std::initializer_list&lt;std::string&gt;{<span class="stringliteral">&quot;outcome4&quot;</span>}, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add states to the state machine.</span></div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;SETTING_INTS&quot;</span>,</div>
<div class="line">                std::make_shared&lt;yasmin::CbState&gt;(</div>
<div class="line">                    std::initializer_list&lt;std::string&gt;{</div>
<div class="line">                        <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>},</div>
<div class="line">                    <a class="code hl_function" href="service__client__demo_8cpp.html#a73d2bd5c99568a599143915a2483201d">set_ints</a>),</div>
<div class="line">                {</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>, <span class="stringliteral">&quot;ADD_TWO_INTS&quot;</span>},</div>
<div class="line">                });</div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;ADD_TWO_INTS&quot;</span>, std::make_shared&lt;AddTwoIntsState&gt;(),</div>
<div class="line">                {</div>
<div class="line">                    {<span class="stringliteral">&quot;outcome1&quot;</span>, <span class="stringliteral">&quot;PRINTING_SUM&quot;</span>},</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>, <span class="stringliteral">&quot;outcome4&quot;</span>},</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#ae27bb90d1a3bef7392009daaf6af5a21">yasmin_ros::basic_outcomes::ABORT</a>, <span class="stringliteral">&quot;outcome4&quot;</span>},</div>
<div class="line">                });</div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;PRINTING_SUM&quot;</span>,</div>
<div class="line">                std::make_shared&lt;yasmin::CbState&gt;(</div>
<div class="line">                    std::initializer_list&lt;std::string&gt;{</div>
<div class="line">                        <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>},</div>
<div class="line">                    <a class="code hl_function" href="service__client__demo_8cpp.html#accc90ce177b13fe70630560b1662ecac">print_sum</a>),</div>
<div class="line">                {</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>, <span class="stringliteral">&quot;outcome4&quot;</span>},</div>
<div class="line">                });</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Publish state machine visualization.</span></div>
<div class="line">  <a class="code hl_class" href="classyasmin__viewer_1_1YasminViewerPub.html">yasmin_viewer::YasminViewerPub</a> yasmin_pub(sm, <span class="stringliteral">&quot;YASMIN_SERVICE_CLIENT_DEMO&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Execute the state machine.</span></div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    std::string outcome = (*sm.get())();</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(outcome.c_str());</div>
<div class="line">  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#ae06a2a3a4eaa2d0fc4d4cc807e7d9d72">YASMIN_LOG_WARN</a>(e.what());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  rclcpp::shutdown();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassAddTwoIntsState_html_a1c88b3b5280dd3eeccfe4eabaaba3f3f"><div class="ttname"><a href="classAddTwoIntsState.html#a1c88b3b5280dd3eeccfe4eabaaba3f3f">AddTwoIntsState::create_request_handler</a></div><div class="ttdeci">example_interfaces::srv::AddTwoInts::Request::SharedPtr create_request_handler(std::shared_ptr&lt; yasmin::Blackboard &gt; blackboard)</div><div class="ttdoc">Creates a service request using values from the blackboard.</div><div class="ttdef"><b>Definition</b> service_client_demo.cpp:98</div></div>
<div class="ttc" id="aclassAddTwoIntsState_html_adafe175a2a8667af73abeee9cd0439f0"><div class="ttname"><a href="classAddTwoIntsState.html#adafe175a2a8667af73abeee9cd0439f0">AddTwoIntsState::AddTwoIntsState</a></div><div class="ttdeci">AddTwoIntsState()</div><div class="ttdoc">Constructor for AddTwoIntsState.</div><div class="ttdef"><b>Definition</b> service_client_demo.cpp:80</div></div>
<div class="ttc" id="aclassyasmin__ros_1_1ServiceState_html"><div class="ttname"><a href="classyasmin__ros_1_1ServiceState.html">yasmin_ros::ServiceState</a></div><div class="ttdoc">A state class that interacts with a ROS 2 service.</div><div class="ttdef"><b>Definition</b> service_state.hpp:48</div></div>
<div class="ttc" id="aclassyasmin__ros_1_1ServiceState_html_a089345db165d860c0b84a755b6cf49e0"><div class="ttname"><a href="classyasmin__ros_1_1ServiceState.html#a089345db165d860c0b84a755b6cf49e0">yasmin_ros::ServiceState&lt; example_interfaces::srv::AddTwoInts &gt;::create_request_handler</a></div><div class="ttdeci">CreateRequestHandler create_request_handler</div><div class="ttdef"><b>Definition</b> service_state.hpp:318</div></div>
<div class="ttc" id="aclassyasmin__ros_1_1ServiceState_html_a250abf3c365cd36e63170b35db29b62c"><div class="ttname"><a href="classyasmin__ros_1_1ServiceState.html#a250abf3c365cd36e63170b35db29b62c">yasmin_ros::ServiceState&lt; example_interfaces::srv::AddTwoInts &gt;::response_handler</a></div><div class="ttdeci">ResponseHandler response_handler</div><div class="ttdef"><b>Definition</b> service_state.hpp:320</div></div>
<div class="ttc" id="anamespaceyasmin__ros_1_1basic__outcomes_html_ae27bb90d1a3bef7392009daaf6af5a21"><div class="ttname"><a href="namespaceyasmin__ros_1_1basic__outcomes.html#ae27bb90d1a3bef7392009daaf6af5a21">yasmin_ros::basic_outcomes::ABORT</a></div><div class="ttdeci">constexpr char ABORT[]</div><div class="ttdoc">Constant representing an aborted action outcome.</div><div class="ttdef"><b>Definition</b> basic_outcomes.hpp:47</div></div>
<div class="ttc" id="aservice__state_8hpp_html"><div class="ttname"><a href="service__state_8hpp.html">service_state.hpp</a></div></div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md26"></a>
Action Demo (FSM + ROS 2 Action)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos fibonacci_action_server</div>
</div><!-- fragment --><div class="fragment"><div class="line">ros2 run yasmin_demos action_client_demo</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;example_interfaces/action/fibonacci.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="cb__state_8hpp.html">yasmin/cb_state.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="logs_8hpp.html">yasmin/logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="state__machine_8hpp.html">yasmin/state_machine.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="action__state_8hpp.html">yasmin_ros/action_state.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="basic__outcomes_8hpp.html">yasmin_ros/basic_outcomes.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ros__logs_8hpp.html">yasmin_ros/ros_logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="yasmin__node_8hpp.html">yasmin_ros/yasmin_node.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="yasmin__viewer__pub_8hpp.html">yasmin_viewer/yasmin_viewer_pub.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>std::placeholders::_1;</div>
<div class="line"><span class="keyword">using </span>std::placeholders::_2;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="action__client__demo_8cpp.html#a6b8442a7f210c0724344924057b54b21">Fibonacci</a> = example_interfaces::action::Fibonacci;</div>
<div class="line"></div>
<div class="line">std::string</div>
<div class="line"><a class="code hl_function" href="action__client__demo_8cpp.html#a15c57adaf02057eb95645e20dec27f4e">print_result</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard) {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> fibo_res = blackboard-&gt;get&lt;std::vector&lt;int&gt;&gt;(<span class="stringliteral">&quot;fibo_res&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  std::stringstream ss;</div>
<div class="line">  ss &lt;&lt; <span class="stringliteral">&quot;Result: [&quot;</span>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; fibo_res.size(); i++) {</div>
<div class="line">    ss &lt;&lt; fibo_res[i];</div>
<div class="line">    <span class="keywordflow">if</span> (i &lt; fibo_res.size() - 1) {</div>
<div class="line">      ss &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  ss &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(ss.str().c_str());</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classFibonacciState.html">FibonacciState</a> : <span class="keyword">public</span> <a class="code hl_class" href="classyasmin__ros_1_1ActionState.html">yasmin_ros::ActionState</a>&lt;Fibonacci&gt; {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code hl_function" href="classFibonacciState.html#a80f2a3be8fb203badc608c4ef5410c0e">FibonacciState</a>()</div>
<div class="line">      : yasmin_ros::<a class="code hl_function" href="classyasmin__ros_1_1ActionState.html#a9b01b7c94f4f4b93786e4d3dbecd5264">ActionState</a>&lt;<a class="code hl_typedef" href="action__client__demo_8cpp.html#a6b8442a7f210c0724344924057b54b21">Fibonacci</a>&gt;(</div>
<div class="line">            <span class="stringliteral">&quot;/fibonacci&quot;</span>,</div>
<div class="line">            std::bind(&amp;<a class="code hl_function" href="classFibonacciState.html#a80f2a3be8fb203badc608c4ef5410c0e">FibonacciState</a>::<a class="code hl_function" href="classFibonacciState.html#a2afed939e313526d91b77621b99dc554">create_goal_handler</a>, this, _1),</div>
<div class="line">            std::bind(&amp;<a class="code hl_function" href="classFibonacciState.html#a80f2a3be8fb203badc608c4ef5410c0e">FibonacciState</a>::<a class="code hl_function" href="classFibonacciState.html#ab1adfc9c094567bbbeb8d55cff10a943">response_handler</a>, this, _1, _2),</div>
<div class="line">            std::bind(&amp;<a class="code hl_function" href="classFibonacciState.html#a80f2a3be8fb203badc608c4ef5410c0e">FibonacciState</a>::<a class="code hl_function" href="classFibonacciState.html#a33ec8834a5a507ddb290f42c9c620b03">print_feedback</a>, this, _1, _2)){};</div>
<div class="line"></div>
<div class="line">  Fibonacci::Goal <a class="code hl_variable" href="classyasmin__ros_1_1ActionState.html#ac1dcef8cc246e1d77bee45d4594f607b">create_goal_handler</a>(</div>
<div class="line">      std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> goal = Fibonacci::Goal();</div>
<div class="line">    goal.order = blackboard-&gt;get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> goal;</div>
<div class="line">  };</div>
<div class="line"></div>
<div class="line">  std::string</div>
<div class="line">  <a class="code hl_function" href="classFibonacciState.html#ab1adfc9c094567bbbeb8d55cff10a943">response_handler</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard,</div>
<div class="line">                   Fibonacci::Result::SharedPtr response) {</div>
<div class="line"> </div>
<div class="line">    blackboard-&gt;set&lt;std::vector&lt;int&gt;&gt;(<span class="stringliteral">&quot;fibo_res&quot;</span>, response-&gt;sequence);</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>;</div>
<div class="line">  };</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  <a class="code hl_function" href="classFibonacciState.html#a33ec8834a5a507ddb290f42c9c620b03">print_feedback</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard,</div>
<div class="line">                 std::shared_ptr&lt;const Fibonacci::Feedback&gt; feedback) {</div>
<div class="line">    (void)blackboard;</div>
<div class="line"> </div>
<div class="line">    std::stringstream ss;</div>
<div class="line">    ss &lt;&lt; <span class="stringliteral">&quot;Received feedback: [&quot;</span>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; feedback-&gt;sequence.size(); i++) {</div>
<div class="line">      ss &lt;&lt; feedback-&gt;sequence[i];</div>
<div class="line">      <span class="keywordflow">if</span> (i &lt; feedback-&gt;sequence.size() - 1) {</div>
<div class="line">        ss &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    ss &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(ss.str().c_str());</div>
<div class="line">  };</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;yasmin_action_client_demo&quot;</span>);</div>
<div class="line">  rclcpp::init(argc, argv);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set ROS 2 logging</span></div>
<div class="line">  <a class="code hl_function" href="namespaceyasmin__ros.html#aa2ab874c02c82fd169c8b3d066ddb106">yasmin_ros::set_ros_loggers</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create the state machine</span></div>
<div class="line">  <span class="keyword">auto</span> sm = std::make_shared&lt;yasmin::StateMachine&gt;(</div>
<div class="line">      std::initializer_list&lt;std::string&gt;{<span class="stringliteral">&quot;outcome4&quot;</span>}, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add states to the state machine</span></div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;CALLING_FIBONACCI&quot;</span>, std::make_shared&lt;FibonacciState&gt;(),</div>
<div class="line">                {</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>, <span class="stringliteral">&quot;PRINTING_RESULT&quot;</span>},</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#aa16f429e9a49afef61173041aeb88525">yasmin_ros::basic_outcomes::CANCEL</a>, <span class="stringliteral">&quot;outcome4&quot;</span>},</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#ae27bb90d1a3bef7392009daaf6af5a21">yasmin_ros::basic_outcomes::ABORT</a>, <span class="stringliteral">&quot;outcome4&quot;</span>},</div>
<div class="line">                });</div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;PRINTING_RESULT&quot;</span>,</div>
<div class="line">                std::make_shared&lt;yasmin::CbState&gt;(</div>
<div class="line">                    std::initializer_list&lt;std::string&gt;{</div>
<div class="line">                        <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>},</div>
<div class="line">                    <a class="code hl_function" href="action__client__demo_8cpp.html#a15c57adaf02057eb95645e20dec27f4e">print_result</a>),</div>
<div class="line">                {</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>, <span class="stringliteral">&quot;outcome4&quot;</span>},</div>
<div class="line">                });</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Publisher for visualizing the state machine</span></div>
<div class="line">  <a class="code hl_class" href="classyasmin__viewer_1_1YasminViewerPub.html">yasmin_viewer::YasminViewerPub</a> yasmin_pub(sm, <span class="stringliteral">&quot;YASMIN_ACTION_CLIENT_DEMO&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create an initial blackboard and set the Fibonacci order</span></div>
<div class="line">  std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard =</div>
<div class="line">      std::make_shared&lt;yasmin::Blackboard&gt;();</div>
<div class="line">  blackboard-&gt;set&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;n&quot;</span>, 10);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Execute the state machine</span></div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    std::string outcome = (*sm.get())(blackboard);</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(outcome.c_str());</div>
<div class="line">  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#ae06a2a3a4eaa2d0fc4d4cc807e7d9d72">YASMIN_LOG_WARN</a>(e.what());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  rclcpp::shutdown();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aaction__client__demo_8cpp_html_a6b8442a7f210c0724344924057b54b21"><div class="ttname"><a href="action__client__demo_8cpp.html#a6b8442a7f210c0724344924057b54b21">Fibonacci</a></div><div class="ttdeci">example_interfaces::action::Fibonacci Fibonacci</div><div class="ttdef"><b>Definition</b> action_client_demo.cpp:33</div></div>
<div class="ttc" id="aaction__state_8hpp_html"><div class="ttname"><a href="action__state_8hpp.html">action_state.hpp</a></div></div>
<div class="ttc" id="aclassFibonacciState_html_a2afed939e313526d91b77621b99dc554"><div class="ttname"><a href="classFibonacciState.html#a2afed939e313526d91b77621b99dc554">FibonacciState::create_goal_handler</a></div><div class="ttdeci">Fibonacci::Goal create_goal_handler(std::shared_ptr&lt; yasmin::Blackboard &gt; blackboard)</div><div class="ttdoc">Callback for creating the Fibonacci action goal.</div><div class="ttdef"><b>Definition</b> action_client_demo.cpp:93</div></div>
<div class="ttc" id="aclassFibonacciState_html_a33ec8834a5a507ddb290f42c9c620b03"><div class="ttname"><a href="classFibonacciState.html#a33ec8834a5a507ddb290f42c9c620b03">FibonacciState::print_feedback</a></div><div class="ttdeci">void print_feedback(std::shared_ptr&lt; yasmin::Blackboard &gt; blackboard, std::shared_ptr&lt; const Fibonacci::Feedback &gt; feedback)</div><div class="ttdoc">Callback for printing action feedback.</div><div class="ttdef"><b>Definition</b> action_client_demo.cpp:127</div></div>
<div class="ttc" id="aclassFibonacciState_html_a80f2a3be8fb203badc608c4ef5410c0e"><div class="ttname"><a href="classFibonacciState.html#a80f2a3be8fb203badc608c4ef5410c0e">FibonacciState::FibonacciState</a></div><div class="ttdeci">FibonacciState()</div><div class="ttdoc">Constructs a new FibonacciState object and initializes callbacks.</div><div class="ttdef"><b>Definition</b> action_client_demo.cpp:77</div></div>
<div class="ttc" id="aclassFibonacciState_html_ab1adfc9c094567bbbeb8d55cff10a943"><div class="ttname"><a href="classFibonacciState.html#ab1adfc9c094567bbbeb8d55cff10a943">FibonacciState::response_handler</a></div><div class="ttdeci">std::string response_handler(std::shared_ptr&lt; yasmin::Blackboard &gt; blackboard, Fibonacci::Result::SharedPtr response)</div><div class="ttdoc">Callback for handling the action response.</div><div class="ttdef"><b>Definition</b> action_client_demo.cpp:110</div></div>
<div class="ttc" id="aclassyasmin__ros_1_1ActionState_html"><div class="ttname"><a href="classyasmin__ros_1_1ActionState.html">yasmin_ros::ActionState</a></div><div class="ttdoc">A state class for handling ROS 2 action client operations.</div><div class="ttdef"><b>Definition</b> action_state.hpp:48</div></div>
<div class="ttc" id="aclassyasmin__ros_1_1ActionState_html_ac1dcef8cc246e1d77bee45d4594f607b"><div class="ttname"><a href="classyasmin__ros_1_1ActionState.html#ac1dcef8cc246e1d77bee45d4594f607b">yasmin_ros::ActionState&lt; Fibonacci &gt;::create_goal_handler</a></div><div class="ttdeci">CreateGoalHandler create_goal_handler</div><div class="ttdef"><b>Definition</b> action_state.hpp:441</div></div>
<div class="ttc" id="anamespaceyasmin__ros_1_1basic__outcomes_html_aa16f429e9a49afef61173041aeb88525"><div class="ttname"><a href="namespaceyasmin__ros_1_1basic__outcomes.html#aa16f429e9a49afef61173041aeb88525">yasmin_ros::basic_outcomes::CANCEL</a></div><div class="ttdeci">constexpr char CANCEL[]</div><div class="ttdoc">Constant representing a canceled action outcome.</div><div class="ttdef"><b>Definition</b> basic_outcomes.hpp:63</div></div>
<div class="ttc" id="ayasmin__node_8hpp_html"><div class="ttname"><a href="yasmin__node_8hpp.html">yasmin_node.hpp</a></div></div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md27"></a>
Parameters Demo (FSM + ROS 2 Parameters)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line">ros2 run yasmin_demos parameters_demo --ros-args -p max_counter:=5</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;rclcpp/rclcpp.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="logs_8hpp.html">yasmin/logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="state_8hpp.html">yasmin/state.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="state__machine_8hpp.html">yasmin/state_machine.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="basic__outcomes_8hpp.html">yasmin_ros/basic_outcomes.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="get__parameters__state_8hpp.html">yasmin_ros/get_parameters_state.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ros__logs_8hpp.html">yasmin_ros/ros_logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="yasmin__viewer__pub_8hpp.html">yasmin_viewer/yasmin_viewer_pub.hpp</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classFooState.html">FooState</a> : <span class="keyword">public</span> <a class="code hl_class" href="classyasmin_1_1State.html">yasmin::State</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a>;</div>
<div class="line"></div>
<div class="line">  <a class="code hl_function" href="classFooState.html#a6ae85df2d67293997c452444c2e0b6a4">FooState</a>() : <a class="code hl_namespace" href="namespaceyasmin.html">yasmin</a>::State({<span class="stringliteral">&quot;outcome1&quot;</span>, <span class="stringliteral">&quot;outcome2&quot;</span>}), <a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a>(0){};</div>
<div class="line"></div>
<div class="line">  std::string</div>
<div class="line">  <a class="code hl_function" href="classFooState.html#ae23bada9c103a9618962d5de0c77bb6b">execute</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard)<span class="keyword"> override </span>{</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;Executing state FOO&quot;</span>);</div>
<div class="line">    std::this_thread::sleep_for(std::chrono::seconds(3));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter &lt; blackboard-&gt;</a>get&lt;int&gt;(<span class="stringliteral">&quot;max_counter&quot;</span>)) {</div>
<div class="line">      this-&gt;<a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a> += 1;</div>
<div class="line">      blackboard-&gt;set&lt;std::string&gt;(<span class="stringliteral">&quot;foo_str&quot;</span>,</div>
<div class="line">                                   blackboard-&gt;get&lt;std::string&gt;(<span class="stringliteral">&quot;counter_str&quot;</span>) +</div>
<div class="line">                                       <span class="stringliteral">&quot;: &quot;</span> + std::to_string(this-&gt;<a class="code hl_variable" href="classFooState.html#a9c41a04e25dfd44c4e7fe32cb3cad467">counter</a>));</div>
<div class="line">      <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome1&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome2&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">  };</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classBarState.html">BarState</a> : <span class="keyword">public</span> <a class="code hl_class" href="classyasmin_1_1State.html">yasmin::State</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code hl_function" href="classBarState.html#afc590f0fcaaea12f89f14582ad60d866">BarState</a>() : yasmin::<a class="code hl_function" href="classyasmin_1_1State.html#a488b68da403b4b9ef55bef22885f1449">State</a>({<span class="stringliteral">&quot;outcome3&quot;</span>}) {}</div>
<div class="line"></div>
<div class="line">  std::string</div>
<div class="line">  <a class="code hl_function" href="classBarState.html#abb4afd02f9a2a473527dc3e139637685">execute</a>(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard)<span class="keyword"> override </span>{</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;Executing state BAR&quot;</span>);</div>
<div class="line">    std::this_thread::sleep_for(std::chrono::seconds(3));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(blackboard-&gt;get&lt;std::string&gt;(<span class="stringliteral">&quot;foo_str&quot;</span>).c_str());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;outcome3&quot;</span>;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">  <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;yasmin_parameters_demo&quot;</span>);</div>
<div class="line">  rclcpp::init(argc, argv);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set ROS 2 logs</span></div>
<div class="line">  <a class="code hl_function" href="namespaceyasmin__ros.html#aa2ab874c02c82fd169c8b3d066ddb106">yasmin_ros::set_ros_loggers</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create a state machine</span></div>
<div class="line">  <span class="keyword">auto</span> sm = std::make_shared&lt;yasmin::StateMachine&gt;(</div>
<div class="line">      std::initializer_list&lt;std::string&gt;{<span class="stringliteral">&quot;outcome4&quot;</span>}, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add states to the state machine</span></div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;GETTING_PARAMETERS&quot;</span>,</div>
<div class="line">                std::make_shared&lt;yasmin_ros::GetParametersState&gt;(</div>
<div class="line">                    std::map&lt;std::string, std::any&gt;{</div>
<div class="line">                        {<span class="stringliteral">&quot;max_counter&quot;</span>, 3},</div>
<div class="line">                        {<span class="stringliteral">&quot;counter_str&quot;</span>, std::string(<span class="stringliteral">&quot;Counter&quot;</span>)},</div>
<div class="line">                    }),</div>
<div class="line">                {</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>, <span class="stringliteral">&quot;FOO&quot;</span>},</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#ae27bb90d1a3bef7392009daaf6af5a21">yasmin_ros::basic_outcomes::ABORT</a>, <span class="stringliteral">&quot;outcome4&quot;</span>},</div>
<div class="line">                });</div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;FOO&quot;</span>, std::make_shared&lt;FooState&gt;(),</div>
<div class="line">                {</div>
<div class="line">                    {<span class="stringliteral">&quot;outcome1&quot;</span>, <span class="stringliteral">&quot;BAR&quot;</span>},</div>
<div class="line">                    {<span class="stringliteral">&quot;outcome2&quot;</span>, <span class="stringliteral">&quot;outcome4&quot;</span>},</div>
<div class="line">                });</div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;BAR&quot;</span>, std::make_shared&lt;BarState&gt;(),</div>
<div class="line">                {</div>
<div class="line">                    {<span class="stringliteral">&quot;outcome3&quot;</span>, <span class="stringliteral">&quot;FOO&quot;</span>},</div>
<div class="line">                });</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Publish state machine updates</span></div>
<div class="line">  <a class="code hl_class" href="classyasmin__viewer_1_1YasminViewerPub.html">yasmin_viewer::YasminViewerPub</a> yasmin_pub(sm, <span class="stringliteral">&quot;YASMIN_PARAMETERS_DEMO&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Execute the state machine</span></div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    std::string outcome = (*sm.get())();</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(outcome.c_str());</div>
<div class="line">  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#ae06a2a3a4eaa2d0fc4d4cc807e7d9d72">YASMIN_LOG_WARN</a>(e.what());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  rclcpp::shutdown();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aget__parameters__state_8hpp_html"><div class="ttname"><a href="get__parameters__state_8hpp.html">get_parameters_state.hpp</a></div></div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md28"></a>
Factory Demo (Plugins)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<blockquote class="doxtable">
<p><b>Note:</b> When mixing Python and C++ states in the same state machine, they can communicate through the blackboard, but only with primitive data types: <code>int</code>, <code>float</code>, <code>bool</code>, and <code>string</code>. Complex objects or ROS messages cannot be directly shared between Python and C++ states. </p>
</blockquote>
<div class="fragment"><div class="line">ros2 run yasmin_demos factory_demo</div>
</div><!-- fragment --><div class="fragment"><div class="line">&lt;<span class="keywordtype">StateMachine</span> <span class="keyword">outcomes</span>=<span class="stringliteral">&quot;outcome4&quot;</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">State</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;Foo&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;py&quot;</span> <span class="keyword">module</span>=<span class="stringliteral">&quot;yasmin_demos.foo_state&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;FooState&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Transition</span> <span class="keyword">from</span>=<span class="stringliteral">&quot;outcome1&quot;</span> <span class="keyword">to</span>=<span class="stringliteral">&quot;Bar&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Transition</span> <span class="keyword">from</span>=<span class="stringliteral">&quot;outcome2&quot;</span> <span class="keyword">to</span>=<span class="stringliteral">&quot;outcome4&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">State</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">State</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;Bar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;cpp&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;yasmin_demos/BarState&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">Transition</span> <span class="keyword">from</span>=<span class="stringliteral">&quot;outcome3&quot;</span> <span class="keyword">to</span>=<span class="stringliteral">&quot;Foo&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">State</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">StateMachine</span>&gt;</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;ament_index_cpp/get_package_share_directory.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;rclcpp/rclcpp.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="state__machine_8hpp.html">yasmin/state_machine.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;yasmin_factory/yasmin_factory.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ros__logs_8hpp.html">yasmin_ros/ros_logs.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">  <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;yasmin_factory_demo&quot;</span>);</div>
<div class="line">  rclcpp::init(argc, argv);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set up ROS 2 loggers</span></div>
<div class="line">  <a class="code hl_function" href="namespaceyasmin__ros.html#aa2ab874c02c82fd169c8b3d066ddb106">yasmin_ros::set_ros_loggers</a>();</div>
<div class="line"> </div>
<div class="line">  std::string outcome;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create the factory in a scope</span></div>
<div class="line">  yasmin_factory::YasminFactory factory;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Load state machine from XML file</span></div>
<div class="line">  std::string xml_file =</div>
<div class="line">      ament_index_cpp::get_package_share_directory(<span class="stringliteral">&quot;yasmin_demos&quot;</span>) +</div>
<div class="line">      <span class="stringliteral">&quot;/state_machines/demo_2.xml&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create the state machine from the XML file</span></div>
<div class="line">  <span class="keyword">auto</span> sm = factory.create_sm_from_file(xml_file);</div>
<div class="line">  sm-&gt;set_sigint_handler(<span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Execute the state machine</span></div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    std::string outcome = (*sm.get())();</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(outcome.c_str());</div>
<div class="line">  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#ae06a2a3a4eaa2d0fc4d4cc807e7d9d72">YASMIN_LOG_WARN</a>(e.what());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Shutdown ROS 2</span></div>
<div class="line">  rclcpp::shutdown();</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p></p>
</details>
<h3><a class="anchor" id="autotoc_md29"></a>
Nav2 Demo (Hierarchical FSM + ROS 2 Action)</h3>
<details >
<summary >
Click to expand</summary>
<p></p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;random&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;geometry_msgs/msg/pose.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;nav2_msgs/action/navigate_to_pose.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="blackboard_8hpp.html">yasmin/blackboard.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="cb__state_8hpp.html">yasmin/cb_state.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="logs_8hpp.html">yasmin/logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="state__machine_8hpp.html">yasmin/state_machine.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="action__state_8hpp.html">yasmin_ros/action_state.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="basic__outcomes_8hpp.html">yasmin_ros/basic_outcomes.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ros__logs_8hpp.html">yasmin_ros/ros_logs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="yasmin__viewer__pub_8hpp.html">yasmin_viewer/yasmin_viewer_pub.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>std::placeholders::_1;</div>
<div class="line"><span class="keyword">using </span>std::placeholders::_2;</div>
<div class="line"><span class="keyword">using </span>NavigateToPose = nav2_msgs::action::NavigateToPose;</div>
<div class="line"><span class="keyword">using </span>Pose = geometry_msgs::msg::Pose;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Constants for state outcomes</span></div>
<div class="line"><span class="keyword">const</span> std::string HAS_NEXT = <span class="stringliteral">&quot;has_next&quot;</span>; </div>
<div class="line"><span class="keyword">const</span> std::string END = <span class="stringliteral">&quot;end&quot;</span>;           </div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span>Nav2State : <span class="keyword">public</span> <a class="code hl_class" href="classyasmin__ros_1_1ActionState.html">yasmin_ros::ActionState</a>&lt;NavigateToPose&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  Nav2State()</div>
<div class="line">      : <a class="code hl_namespace" href="namespaceyasmin__ros.html">yasmin_ros</a>::ActionState&lt;NavigateToPose&gt;(</div>
<div class="line">            <span class="stringliteral">&quot;/navigate_to_pose&quot;</span>,</div>
<div class="line">            std::bind(&amp;Nav2State::create_goal_handler, this, _1)) {}</div>
<div class="line"></div>
<div class="line">  NavigateToPose::Goal <a class="code hl_variable" href="classyasmin__ros_1_1ActionState.html#ac1dcef8cc246e1d77bee45d4594f607b">create_goal_handler</a>(</div>
<div class="line">      std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard) {</div>
<div class="line">    NavigateToPose::Goal goal;</div>
<div class="line">    goal.pose.pose = blackboard-&gt;get&lt;Pose&gt;(<span class="stringliteral">&quot;pose&quot;</span>);</div>
<div class="line">    goal.pose.header.frame_id = <span class="stringliteral">&quot;map&quot;</span>; <span class="comment">// Set the reference frame to &#39;map&#39;</span></div>
<div class="line">    <span class="keywordflow">return</span> goal;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line">std::string</div>
<div class="line">create_waypoints(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard) {</div>
<div class="line">  std::map&lt;std::string, std::vector&lt;double&gt;&gt; waypoints = {</div>
<div class="line">      {<span class="stringliteral">&quot;entrance&quot;</span>, {1.25, 6.30, -0.78, 0.67}},</div>
<div class="line">      {<span class="stringliteral">&quot;bathroom&quot;</span>, {4.89, 1.64, 0.0, 1.0}},</div>
<div class="line">      {<span class="stringliteral">&quot;livingroom&quot;</span>, {1.55, 4.03, -0.69, 0.72}},</div>
<div class="line">      {<span class="stringliteral">&quot;kitchen&quot;</span>, {3.79, 6.77, 0.99, 0.12}},</div>
<div class="line">      {<span class="stringliteral">&quot;bedroom&quot;</span>, {7.50, 4.89, 0.76, 0.65}}};</div>
<div class="line">  blackboard-&gt;set&lt;std::map&lt;std::string, std::vector&lt;double&gt;&gt;&gt;(<span class="stringliteral">&quot;waypoints&quot;</span>,</div>
<div class="line">                                                              waypoints);</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">std::string take_random_waypoint(</div>
<div class="line">    std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard) {</div>
<div class="line">  <span class="keyword">auto</span> waypoints =</div>
<div class="line">      blackboard-&gt;get&lt;std::map&lt;std::string, std::vector&lt;double&gt;&gt;&gt;(<span class="stringliteral">&quot;waypoints&quot;</span>);</div>
<div class="line">  <span class="keywordtype">int</span> waypoints_num = blackboard-&gt;get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;waypoints_num&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  std::vector&lt;std::string&gt; waypoint_names;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;pair : waypoints) {</div>
<div class="line">    waypoint_names.push_back(pair.first);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Randomly select waypoints_num waypoints</span></div>
<div class="line">  std::random_device rd;</div>
<div class="line">  std::mt19937 g(rd());</div>
<div class="line">  std::shuffle(waypoint_names.begin(), waypoint_names.end(), g);</div>
<div class="line">  std::vector&lt;std::string&gt; random_waypoints(</div>
<div class="line">      waypoint_names.begin(), waypoint_names.begin() + waypoints_num);</div>
<div class="line"> </div>
<div class="line">  blackboard-&gt;set&lt;std::vector&lt;std::string&gt;&gt;(<span class="stringliteral">&quot;random_waypoints&quot;</span>,</div>
<div class="line">                                            random_waypoints);</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">std::string</div>
<div class="line">get_next_waypoint(std::shared_ptr&lt;yasmin::Blackboard&gt; blackboard) {</div>
<div class="line">  <span class="keyword">auto</span> random_waypoints =</div>
<div class="line">      blackboard-&gt;get&lt;std::vector&lt;std::string&gt;&gt;(<span class="stringliteral">&quot;random_waypoints&quot;</span>);</div>
<div class="line">  <span class="keyword">auto</span> waypoints =</div>
<div class="line">      blackboard-&gt;get&lt;std::map&lt;std::string, std::vector&lt;double&gt;&gt;&gt;(<span class="stringliteral">&quot;waypoints&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (random_waypoints.empty()) {</div>
<div class="line">    <span class="keywordflow">return</span> END;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  std::string wp_name = random_waypoints.back();</div>
<div class="line">  random_waypoints.pop_back();</div>
<div class="line">  blackboard-&gt;set&lt;std::vector&lt;std::string&gt;&gt;(<span class="stringliteral">&quot;random_waypoints&quot;</span>,</div>
<div class="line">                                            random_waypoints);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> wp = waypoints.at(wp_name);</div>
<div class="line"> </div>
<div class="line">  Pose pose;</div>
<div class="line">  pose.position.x = wp[0];</div>
<div class="line">  pose.position.y = wp[1];</div>
<div class="line">  pose.orientation.z = wp[2];</div>
<div class="line">  pose.orientation.w = wp[3];</div>
<div class="line"> </div>
<div class="line">  blackboard-&gt;set&lt;Pose&gt;(<span class="stringliteral">&quot;pose&quot;</span>, pose);</div>
<div class="line">  blackboard-&gt;set&lt;std::string&gt;(<span class="stringliteral">&quot;text&quot;</span>, <span class="stringliteral">&quot;I have reached waypoint &quot;</span> + wp_name);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> HAS_NEXT;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="test__blackboard_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">  <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(<span class="stringliteral">&quot;yasmin_nav2_demo&quot;</span>);</div>
<div class="line">  rclcpp::init(argc, argv);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set ROS 2 logs</span></div>
<div class="line">  <a class="code hl_function" href="namespaceyasmin__ros.html#aa2ab874c02c82fd169c8b3d066ddb106">yasmin_ros::set_ros_loggers</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create state machines</span></div>
<div class="line">  <span class="keyword">auto</span> sm = std::make_shared&lt;yasmin::StateMachine&gt;(</div>
<div class="line">      std::initializer_list&lt;std::string&gt;{<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>,</div>
<div class="line">                                         <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#ae27bb90d1a3bef7392009daaf6af5a21">yasmin_ros::basic_outcomes::ABORT</a>,</div>
<div class="line">                                         <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#aa16f429e9a49afef61173041aeb88525">yasmin_ros::basic_outcomes::CANCEL</a>},</div>
<div class="line">      <span class="keyword">true</span>);</div>
<div class="line">  <span class="keyword">auto</span> nav_sm = std::make_shared&lt;yasmin::StateMachine&gt;(</div>
<div class="line">      std::initializer_list&lt;std::string&gt;{<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>,</div>
<div class="line">                                         <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#ae27bb90d1a3bef7392009daaf6af5a21">yasmin_ros::basic_outcomes::ABORT</a>,</div>
<div class="line">                                         <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#aa16f429e9a49afef61173041aeb88525">yasmin_ros::basic_outcomes::CANCEL</a>});</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add states to the state machine</span></div>
<div class="line">  sm-&gt;add_state(</div>
<div class="line">      <span class="stringliteral">&quot;CREATING_WAYPOINTS&quot;</span>,</div>
<div class="line">      std::make_shared&lt;yasmin::CbState&gt;(</div>
<div class="line">          std::initializer_list&lt;std::string&gt;{</div>
<div class="line">              <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>},</div>
<div class="line">          create_waypoints),</div>
<div class="line">      std::map&lt;std::string, std::string&gt;{</div>
<div class="line">          {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>, <span class="stringliteral">&quot;TAKING_RANDOM_WAYPOINTS&quot;</span>}});</div>
<div class="line">  sm-&gt;add_state(<span class="stringliteral">&quot;TAKING_RANDOM_WAYPOINTS&quot;</span>,</div>
<div class="line">                std::make_shared&lt;yasmin::CbState&gt;(</div>
<div class="line">                    std::initializer_list&lt;std::string&gt;{</div>
<div class="line">                        <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>},</div>
<div class="line">                    take_random_waypoint),</div>
<div class="line">                std::map&lt;std::string, std::string&gt;{</div>
<div class="line">                    {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>, <span class="stringliteral">&quot;NAVIGATING&quot;</span>}});</div>
<div class="line"> </div>
<div class="line">  nav_sm-&gt;add_state(</div>
<div class="line">      <span class="stringliteral">&quot;GETTING_NEXT_WAYPOINT&quot;</span>,</div>
<div class="line">      std::make_shared&lt;yasmin::CbState&gt;(</div>
<div class="line">          std::initializer_list&lt;std::string&gt;{END, HAS_NEXT}, get_next_waypoint),</div>
<div class="line">      std::map&lt;std::string, std::string&gt;{</div>
<div class="line">          {END, <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>},</div>
<div class="line">          {HAS_NEXT, <span class="stringliteral">&quot;NAVIGATING&quot;</span>}});</div>
<div class="line">  nav_sm-&gt;add_state(</div>
<div class="line">      <span class="stringliteral">&quot;NAVIGATING&quot;</span>, std::make_shared&lt;Nav2State&gt;(),</div>
<div class="line">      std::map&lt;std::string, std::string&gt;{</div>
<div class="line">          {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>, <span class="stringliteral">&quot;GETTING_NEXT_WAYPOINT&quot;</span>},</div>
<div class="line">          {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#aa16f429e9a49afef61173041aeb88525">yasmin_ros::basic_outcomes::CANCEL</a>,</div>
<div class="line">           <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#aa16f429e9a49afef61173041aeb88525">yasmin_ros::basic_outcomes::CANCEL</a>},</div>
<div class="line">          {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#ae27bb90d1a3bef7392009daaf6af5a21">yasmin_ros::basic_outcomes::ABORT</a>,</div>
<div class="line">           <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#ae27bb90d1a3bef7392009daaf6af5a21">yasmin_ros::basic_outcomes::ABORT</a>}});</div>
<div class="line"> </div>
<div class="line">  sm-&gt;add_state(</div>
<div class="line">      <span class="stringliteral">&quot;NAVIGATING&quot;</span>, nav_sm,</div>
<div class="line">      std::map&lt;std::string, std::string&gt;{{<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>,</div>
<div class="line">                                          <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#a5573f527607429f73c199d683f78a6a7">yasmin_ros::basic_outcomes::SUCCEED</a>},</div>
<div class="line">                                         {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#aa16f429e9a49afef61173041aeb88525">yasmin_ros::basic_outcomes::CANCEL</a>,</div>
<div class="line">                                          <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#aa16f429e9a49afef61173041aeb88525">yasmin_ros::basic_outcomes::CANCEL</a>},</div>
<div class="line">                                         {<a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#ae27bb90d1a3bef7392009daaf6af5a21">yasmin_ros::basic_outcomes::ABORT</a>,</div>
<div class="line">                                          <a class="code hl_variable" href="namespaceyasmin__ros_1_1basic__outcomes.html#ae27bb90d1a3bef7392009daaf6af5a21">yasmin_ros::basic_outcomes::ABORT</a>}});</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Publish FSM information for visualization</span></div>
<div class="line">  <a class="code hl_class" href="classyasmin__viewer_1_1YasminViewerPub.html">yasmin_viewer::YasminViewerPub</a> yasmin_pub(sm, <span class="stringliteral">&quot;YASMIN_NAV2_DEMO&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Execute the state machine</span></div>
<div class="line">  <span class="keyword">auto</span> blackboard = std::make_shared&lt;yasmin::Blackboard&gt;();</div>
<div class="line">  blackboard-&gt;set&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;waypoints_num&quot;</span>,</div>
<div class="line">                       2); <span class="comment">// Set the number of waypoints to navigate</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    std::string outcome = (*sm.get())(blackboard);</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#a054be408d85e8c53f3265107512555bd">YASMIN_LOG_INFO</a>(outcome.c_str());</div>
<div class="line">  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line">    <a class="code hl_define" href="logs_8hpp.html#ae06a2a3a4eaa2d0fc4d4cc807e7d9d72">YASMIN_LOG_WARN</a>(e.what());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  rclcpp::shutdown();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="ablackboard_8hpp_html"><div class="ttname"><a href="blackboard_8hpp.html">blackboard.hpp</a></div></div>
</div><!-- fragment --><p></p>
</details>
<h1><a class="anchor" id="autotoc_md30"></a>
YASMIN Editor</h1>
<p>The <b>YASMIN Editor</b> is a graphical user interface application for building YASMIN state machines using state plugins. It enables intuitive creation of state machines through drag-and-drop functionality, allowing you to:</p>
<ul>
<li>Load Python and C++ states</li>
<li>Load XML state machines</li>
<li>Define transitions between states</li>
<li>Create outcomes</li>
<li>Visualize state machine structure</li>
</ul>
<p>State machines can be exported and saved in XML format for reuse and sharing.</p>
<p><img src="./docs/editor.png" alt="YASMIN Editor Interface" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md31"></a>
Getting Started</h2>
<div class="fragment"><div class="line">ros2 run yasmin_editor yasmin_editor</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md32"></a>
YASMIN Viewer</h1>
<p>The <b>YASMIN Viewer</b> provides a convenient way to monitor <b>YASMIN</b>'s Finite State Machines (FSM). It is built using <b>Flask</b> and <b>ReactJS</b> and includes a filter to focus on a single FSM at a time.</p>
<p><img src="./docs/viewer.gif" alt="YASMIN Viewer" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md33"></a>
Getting Started</h2>
<div class="fragment"><div class="line">ros2 run yasmin_viewer yasmin_viewer_node</div>
</div><!-- fragment --><p>Once started, open <a href="http://localhost:5000/">http://localhost:5000/</a> in your browser to view your state machines.</p>
<h2><a class="anchor" id="autotoc_md34"></a>
Custom host and port</h2>
<p>You can specify a custom host and port by using the following command:</p>
<div class="fragment"><div class="line">ros2 run yasmin_viewer yasmin_viewer_node --ros-args -p host:=127.0.0.1 -p port:=5032</div>
</div><!-- fragment --><p>After running the command, access your state machines at <a href="http://127.0.0.1:5032/">http://127.0.0.1:5032/</a>.</p>
<h1><a class="anchor" id="autotoc_md35"></a>
Citations</h1>
<div class="fragment"><div class="line">@InProceedings{10.1007/978-3-031-21062-4_43,</div>
<div class="line">author=&quot;Gonz{\&#39;a}lez-Santamarta, Miguel {\&#39;A}.</div>
<div class="line">and Rodr{\&#39;i}guez-Lera, Francisco J.</div>
<div class="line">and Matell{\&#39;a}n-Olivera, Vicente</div>
<div class="line">and Fern{\&#39;a}ndez-Llamas, Camino&quot;,</div>
<div class="line">editor=&quot;Tardioli, Danilo</div>
<div class="line">and Matell{\&#39;a}n, Vicente</div>
<div class="line">and Heredia, Guillermo</div>
<div class="line">and Silva, Manuel F.</div>
<div class="line">and Marques, Lino&quot;,</div>
<div class="line">title=&quot;YASMIN: Yet Another State MachINe&quot;,</div>
<div class="line">booktitle=&quot;ROBOT2022: Fifth Iberian Robotics Conference&quot;,</div>
<div class="line">year=&quot;2023&quot;,</div>
<div class="line">publisher=&quot;Springer International Publishing&quot;,</div>
<div class="line">address=&quot;Cham&quot;,</div>
<div class="line">pages=&quot;528--539&quot;,</div>
<div class="line">abstract=&quot;State machines are a common mechanism for defining behaviors in robots where each behavior is based on identifiable stages. There are several libraries available for easing the implementation of state machines in ROS 1, however, the community was focused on SMACH or SMACC. Although these tools are still predominant, there are fewer alternatives for ROS 2. Besides, Behavior Trees are spreading fast, but there is a niche for using State Machines. Here, YASMIN is presented as yet another library specifically designed for ROS 2 for easing the design of robotic behaviors using state machines. It is available in C++ and Python, and provides some default states to speed up the development, in addition to a web viewer for monitoring the execution of the system and helping in the debugging.&quot;,</div>
<div class="line">isbn=&quot;978-3-031-21062-4&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">@misc{yasmin,</div>
<div class="line">  doi = {10.48550/ARXIV.2205.13284},</div>
<div class="line">  url = {https://arxiv.org/abs/2205.13284},</div>
<div class="line">  author = {Gonzlez-Santamarta, Miguel ngel and Rodrguez-Lera, Francisco Javier and Llamas, Camino Fernndez and Rico, Francisco Martn and Olivera, Vicente Matelln},</div>
<div class="line">  keywords = {Robotics (cs.RO), FOS: Computer and information sciences, FOS: Computer and information sciences},</div>
<div class="line">  title = {YASMIN: Yet Another State MachINe library for ROS 2},</div>
<div class="line">  publisher = {arXiv},</div>
<div class="line">  year = {2022},</div>
<div class="line">  copyright = {Creative Commons Attribution Non Commercial No Derivatives 4.0 International}</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
